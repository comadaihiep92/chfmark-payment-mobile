function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,a){if(e){if("string"==typeof e)return _arrayLikeToArray(e,a);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,a):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,a){(null==a||a>e.length)&&(a=e.length);for(var t=0,s=Array(a);t<a;t++)s[t]=e[t];return s}function ownKeys(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);a&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,s)}return t}function _objectSpread(e){for(var a=1,t;a<arguments.length;a++)t=null==arguments[a]?{}:arguments[a],a%2?ownKeys(Object(t),!0).forEach(function(a){_defineProperty(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))});return e}function _defineProperty(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var saveAddress=0,checkoutobj={},ga_checkoutobj={},sso_data="",analyticsObj={state:"",substate:"",shipment_id:"",shipment_type:"",split:"",city:"",hub:"",user_type:"",item_count:"",item_list:"",category_list:"",amount:"",discount:""},slot_id=0,invoice_order_id="",invoice_order_date="";li_fn={contactless:{checkForContactLess:function(e){return!(!e||!e.enable)},city_name:"",populateContactlessDetails:function(e){var a=e.title,t=e.description,s=e.is_selected,i=e.is_mandatory,o=e.deep_link;$(".contactless-deliver-header").html(a),$(".contactless-delivery-message").html(t),$(".contactless-deliver-option").show(),!o?($(".contactless-view").hide(),$(".contactless-delivery-message").css("margin-top","10px")):($(".contactless-view").attr("href",o),$(".contactless-view").show()),s?$("#contactless_checkbox").prop("checked",!0):$("#contactless_checkbox").prop("checked",!1),i?($("#contactless_checkbox").prop("disabled",!0),$("#contactless_checkbox").unbind("click"),$(".contactless-deliver-option").unbind("click"),$("#contactless_del").hide(),$(".contactless-deliver-header").css("margin-left","0%"),$(".contactless-delivery-message").css("margin-left","0%")):($("#contactless_del").show(),$("#contactless_checkbox").prop("disabled",!1),$("#contactless_checkbox").on("click",function(a){a.stopPropagation(),li_fn.contactless.updateContactlessState().then(function(){li_fn.checkout.populateBillDetailsfromWallet()})}),$(".contactless-deliver-option").on("click",function(a){if(!$(a.target).hasClass("checkmark")&&!$(a.target).hasClass("contactless-view")){var e=$("#contactless_checkbox");e.is(":checked")?e.prop("checked",!1):e.prop("checked",!0),li_fn.contactless.updateContactlessState().then(function(){li_fn.checkout.populateBillDetailsfromWallet()})}}))},updateContactlessState:function(){fn.msite.showloader();var e=!0,a=$("#contactless_checkbox");return a.is(":checked")||(e=!1),new Promise(function(a,t){fn.ajaxForm({selected:e},"POST","/update-contactless-state").done(function(e){try{var s=JSON.parse(e);"success"===s.statusMessage&&(a(s),s.data&&s.data.charges_split&&li_fn.contactless.updateBillDetails(s.data.charges_split))}catch(e){fn.msite.hideloader(),t("err")}}).fail(function(){t("err")}).always(function(){fn.msite.hideloader()})})},updateBillDetails:function(e){$(".payment-charges").html(""),$.map(e,function(e){if("total"!=e.key.toLowerCase()){var a="wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase()?"L_wallet":"",t=e.message===void 0?"":"<span class=\"message\">"+e.message+"</span>";t=("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&0>=e.value?"<span class=\"message\" style=\"color:#417505\">"+e.message+"</span>":t;var s="<li class=\"pay_list \"><div class=\"key\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"value "+a+"\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</div></li>";$(".payment-charges").append(s)}else{fn.paypalPaymentHandler(e.value),$(".pay-amount").html((+(+e.value).toFixed(2)).toString()),$(".order").attr("data-payable_amount",+e.value),localStorage.setItem("final_amt",+e.value),localStorage.setItem("li_pay_amt",+e.value);var i="<li><div class=\"seperator\"></li><li><div class=\"key-total\"><span>"+e.attribute+"</span></div><div class=\"value-total "+a+"\">"+e.value+"</div></li>";$(".payment-charges").append(i)}})}},map_hub_loc:null,map_home_loc:null,renderStaticMap:function(e){console.log("caal"),li_fn.map_home_loc={lat:+e.address_info.lat,lng:+e.address_info.lng},li_fn.map_hub_loc={lat:+e.hub_info.lat,lng:+e.hub_info.lng},$(".arrivalInfoBlade").hide(),$("#map").show(),$("#webView").attr("src",""),$("#webView").css("display","none"),li_fn.checkout.showMap(li_fn.map_hub_loc,li_fn.map_home_loc)},handleMapView:function(e){fn.msite.showloader(),fn.ajaxForm({order_id:$(".shipmentText.active").attr("data-order_id"),customer_key:e},"POST","/track-order-not-logged-in").done(function(e){var a=JSON.parse(e),t=a.data.order;"success"==a.statusMessage?li_fn.checkout.validateLiveTrack(t.live_track_data)&&($("#de_info_msg").html(""),$("#de_info_num a").attr("href",""),fn.msite.hideloader(),$("#map").show(),li_fn.checkout.renderTrackLiveView(t.live_track_data),$("#de_info_msg").html(t.shipment_stages[2].message),$("#de_info_num a").attr("href","tel:"+t.live_track_data.de_phone)):(fn.msite.hideloader(),$("#map").length&&$("#map").hide(),$("#webView").length&&$("#webView").hide(),$(".newShipmentHeaderContainer").show(),$(".arrivalInfoBlade").hide())})},handleProductBarClick:function(){$(document).on("click",".productCartContainer",function(){var e=$(this).attr("cat"),a=$(this).attr("p_name"),t=$(this).attr("cat_slug"),s=$(this).attr("prod_slug"),i=Object.assign({productname:a,category:e},analyticsObj),o=Object.assign({Source:"post_order"},i);clevertap.event.push("order_status_view_product",o),ga("send",{hitType:"event",eventCategory:"post_order",eventAction:"order_status_view_product",eventLabel:JSON.stringify(i)}),""!=t&&""!=s&&(e=e.toLowerCase(),setTimeout(function(){window.location.href="/"+t+"/"+s},300))})},renderProductList:function(e){$.map(e,function(e){var a=e.category_list.split(",");"undefined"!=typeof a&&0<a.length&&0!=a[0]&&(a=a[0]);var t=0<e.discount?"<span class=\"priceGrey\">MRP:</span><span class=\"priceCancelled\">\u20B9"+e.actual_price+"</span><span class=\"actualPrice\">\u20B9 "+"".concat(0<e.base_price?e.base_price:"FREE")+"</span>":"<span class=\"priceGrey\">MRP:</span><span class=\"actualPrice\">\u20B9 "+"".concat(0<e.base_price?e.base_price:"FREE")+"</span>",s=0;s=e.is_grammage_edited&&e.is_order_edited?1:e.is_grammage_edited?2:e.is_order_edited?3:0;var i="<div class=\"productCartContainer".concat(!e.is_deleted?" avaliableproducts":" unavaliableproducts","\" cat=\"").concat(a,"\" cat_slug=\"").concat(e.category_list_slug,"\" p_name=\"").concat(e.product_name,"\" prod_slug=\"").concat(e.product_slug,"\">")+"<div class=\"productCardImage\"><img src="+e.image+"></div><div class=\"productNameAndDescContainer\"><div class=\"productName\">"+e.product_name+"".concat(1==s?"*":"")+"</div><div class=\"productDescContainer\"><span class=\"weightSpan\">"+e.weight+"".concat(2==s?"*":"")+"</span><span class=\"lineSpan\"></span>"+t+"<span class=\"lineSpan\"></span><span class=\"quantity\">Qty: "+e.quantity+"".concat(3==s?"*":"")+"</span></div>"+"".concat(!e.new_weight_message?"":"<div class=\"netweight-message".concat(!e.is_deleted?"":"-deleted","\">").concat(e.new_weight_message,"<img src=\"").concat(!e.is_deleted?"/images/information@3x.png":"/images/information.png","\" class=\"info\"></div>"));"</div></div>",$(".newShipProductsWrapper").append(i)}),$(".netweight-message .info").on("click",function(a){a.stopImmediatePropagation(),$("html, body").animate({scrollTop:$(".BillCardContainer").position().top})}),$(".netweight-message-deleted .info").on("click",function(a){a.stopImmediatePropagation(),$("html, body").animate({scrollTop:$(".BillCardContainer").position().top})})},sendAnalyticsData:function(e,a){var t=li_fn.addCleverTapAttr(a);clevertap.event.push(e,t),ga("send",{hitType:"event",eventCategory:a,eventAction:e,eventLabel:JSON.stringify(analyticsObj)})},showLongMessage:function(e){var a="successLowerLine";return 78<e.length&&(a="longSuccessLowerLine"),a},showLongMessageTwo:function(e){var a="concentricNormalLowerLine";return 78<e.length&&(a="longConcentricNormalLowerLine"),a},mapAnalyticsAttributes:function(e,a){if("track-order"===a)5>e.state_id?(analyticsObj.state=e.shipment_stages[e.state_id-1].status_message,analyticsObj.substate=e.shipment_stages[e.state_id-1].message):(analyticsObj.state="rejected",analyticsObj.substate="rejected");else{var t=function(e){return"discount"==e.key.toLowerCase()};analyticsObj.shipment_id=e.order_id,localStorage.setItem("analytics_shipment_id",e.order_id),analyticsObj.shipment_type="1"==e.express?"Express":"Scheduled",localStorage.setItem("analytics_shipment_type",analyticsObj.shipment_type),analyticsObj.split=e.shipment_items.map(function(e){return e.is_split})[0].toString(),analyticsObj.city=localStorage.getItem("city"),analyticsObj.hub=localStorage.getItem("hub"),analyticsObj.item_count=e.shipment_items.length.toString(),analyticsObj.item_list=e.shipment_items.map(function(e){return e.product_name}).join(),localStorage.setItem("item_list",analyticsObj.item_list),analyticsObj.category_list=e.shipment_items.map(function(e){return e.category_list}).join(),localStorage.setItem("category_list",analyticsObj.category_list),analyticsObj.amount=e.amount.total.toString(),analyticsObj.discount=e.amount.split[e.amount.split.findIndex(t)].value.toString(),localStorage.setItem("analytics_discount",analyticsObj.discount),5>e.state_id?(analyticsObj.state=e.shipment_stages[e.state_id-1].status_message,analyticsObj.substate=e.shipment_stages[e.state_id-1].message):(analyticsObj.state="rejected",analyticsObj.substate="rejected")}},addCleverTapAttr:function(e){var a=Object.assign({Source:e},analyticsObj);return a},addWebEngageAttr:function(e){var a=Object.assign({Source:e},analyticsObj);return a},flushOldContents:function(){$(".rr-wrap").hide(),$(".newOrderStatusContainer").html(""),$(".newShipmentHeaderContainer .headerContent").html(""),$(".info_message").hide()},favItems:function(){fn.ajaxForm({},"GET","/home/favourite-items").done(function(e){var a=JSON.parse(e);if(logged_in_status=fn.getLoginStatus(),!!a&&200===a.statusCode&&"true"==logged_in_status&&0<a.data.length&&!0==a.data[0].is_eligible){var t="<div class=\"favourite_order\" id="+a.data[0].type+"><img class=\"heart\" src="+a.data[0].icon+"><div class=\"favourite_order_caption\"><div class=\"favourite_order_caption_heading\">"+a.data[0].header_text+"</div></div><div class=\"favourite_order_arrow\"><img class=\"arrow\" src=\"/images/right-arrow.png\"></div> </div> <div class=\"past_order\" id="+a.data[1].type+"><img class=\"heart\" src="+a.data[1].icon+"><div class=\"past_order_caption\"><div class=\"past_order_caption_heading\">"+a.data[1].header_text+"</div> </div><div class=\"past_order_arrow\"><img class=\"arrow\" src=\"/images/right-arrow.png\"></div></div>";$(".reorder").html(t),$("#favourite_items").on("click",function(){window.location.href="/favourite-items?src=homepage_widget"}),$("#past_orders").on("click",function(){window.location.href="/past-orders?src=homepage_widget"})}})},validateInvoiceImageDisplay:function(e){return null!=e.shipment_stages&&null!=e.shipment_stages[1]&&null!=e.shipment_stages[1].cta_info&&null!=e.shipment_stages[1].cta_info.value},generateBillList:function(e){var a="",t="";$.map(e,function(e){var s="";"total"===e.key.toLowerCase()?s="<li ><div class=\"seperator\"></div></li><li>"+"<span class=\"totalList\">".concat(e.attribute,"</span>")+"<span class=\"totalValue\">\u20B9 "+e.value+"</span></li>":"extragrammage"==e.key?(a="<li style=\"display: flex;flex-direction: column;\"><div class=\"top-breakup\"><span class=\"key\">"+e.attribute+"</span><span class=\"value\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</span></div><div class=\"bill-breakup-message\" style=\"color : #d47015\">"+e.message+"</div>","</li>"):"revisedamount"==e.key?t="<li ><div class=\"seperator\"></div></li><li><span class=\"totalList\">"+e.attribute+"</span><span class=\"totalValue\">\u20B9 "+e.value+"</span></li>":"overdue"==e.key?s="<li style=\"display: flex;flex-direction: column;\"><div class=\"top-breakup\"><span class=\"key\">"+e.attribute+"</span><span class=\"value\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</span></div>"+"<div class=\"bill-breakup-message\" style=\"color : #d47015\">".concat(e.message,"</div>")+"</li>":"delivery_charge"==e.key&&0==e.value?s="<li style=\"display: flex;flex-direction: column;\"><div class=\"top-breakup\"><span class=\"key\">"+e.attribute+"</span><span class=\"value\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</span></div>"+"<div class=\"bill-breakup-message\" style=\"color : #427605;\">".concat(e.message,"</div>")+"</li>":(s="<li style=\"display: flex;flex-direction: column;\"><div class=\"top-breakup\"><span class=\"key\">"+e.attribute+"</span><span class=\"value\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</span></div><div class=\"bill-breakup-message\">"+e.message+"</div>","</li>"),$(".BillCardContainer ul").append(s)}),!t||(!!a&&$(".BillCardContainer ul").append(a),$(".BillCardContainer ul").append(t))},validateShipments:function(e){return e.shipment_stages&&Array.isArray(e.shipment_stages)&&4===e.shipment_stages.length},getInvoiceURL:function(e){var a=Object.assign({Source:"post_order"},analyticsObj);clevertap.event.push("order_status_view_bill",a),ga("send",{hitType:"event",eventCategory:"post_order",eventAction:"track_order_view_bill",eventLabel:JSON.stringify(analyticsObj)});var t=e.split("_")[0],s=new Date(e.split("_")[1]);s=s.toISOString().split("T")[0],fn.msite.showloader(),new Promise(function(e,a){fn.ajaxForm({order_id:t,order_date:s},"GET","/get-invoice-url").done(function(e){var a=JSON.parse(e);if(200==a.statusCode){var t=document.createElement("a");t.download=a.data,t.href=a.data,t.target="_blank",t.click(),fn.msite.hideloader()}else fn.msite.hideloader(),alert("Something went wrong try again.")}).fail(function(e){a(e)})})["catch"](function(){fn.msite.hideloader()})},getStateOneTimeLine:function(e,a){var t=e[1].cta_info&&e[1].cta_info.value?"<div class=\"BillContainerActive\"><img src=\"/images/bill generated.svg\" download></div>":"<div class=\"BillContainerInactive\"><img src=\"/images/Disabled copy.svg\"></div>";return"<div class=\"container\"><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"successTick\"><img src=\"/images/checked.png\"/></div><div class="+li_fn.showLongMessage(e[0].message)+"></div></div><div class=\"firstStateTextContainer\"><div class=\"stateText\">"+e[0].status_message+"</div><div class=\"subStateText\">"+e[0].message+"</div></div></div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"normalUpperLine\"></div><div class=\"normalTick\"></div><div class=\"normalLowerLine\"></div></div><div class=\"secondStateTextContainer\"><div class=\"stateTextInactive\">"+e[1].status_message+"</div>"+a+t+"</div></div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"normalUpperLine\"></div><div class=\"normalTick\"></div><div class=\"normalLowerLine\"></div></div><div class=\"secondStateTextContainer\"><div class=\"stateTextInactive\">"+e[2].status_message+"</div>"+"<div class=\"phoneContainerInactive\"><img src=\"/images/Disabled.svg\"></div>"+"</div></div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"normalUpperLine\"></div><div class=\"normalTick\"></div></div><div class=\"normalStateTextContainer\"><div class=\"stateTextInactive\">"+e[3].status_message+"</div></div></div></div>"},getStateTwoTimeLine:function(e,a){var t=e[1].cta_info&&e[1].cta_info.value?"<div class=\"concentricBillActive\"><img src=\"/images/bill generated.svg\" download></div>":"<div class=\"concentricBillInactive\"><img src=\"/images/Disabled copy.svg\"></div>";return"<div class=\"container\"><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"successTick\"><img src=\"/images/checked.png\")></div><div class="+li_fn.showLongMessage(e[0].message)+"></div></div><div class=\"firstStateTextContainer\"><div class=\"stateText\">"+e[0].status_message+"</div><div class=\"subStateText\">"+e[0].message+"</div></div></div><div class=\"concentricStateBar\"><div class=\"tickimageLineContainer\"><div class=\"concentricSuccessUpperLine\"></div><div class=\"circle-ripple\"></div><div class="+li_fn.showLongMessageTwo(e[1].message)+"></div></div><div class=\"concentricStateTextContainer\"><div class=\"stateText\">"+e[1].status_message+"</div><div class=\"subStateText\">"+e[1].message+"</div>"+a+t+"</div>"+"".concat(!e[1].eg_message?"":"<div class=\"eg-message\">".concat(e[1].eg_message,"<img src=\"/images/information@3x.png\" class=\"info\"></div>"))+"</div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"normalUpperLine\"></div><div class=\"normalTick\"></div><div class=\"normalLowerLine\"></div></div><div class=\"secondStateTextContainer\"><div class=\"stateTextInactive\">"+e[2].status_message+"</div>"+"<div class=\"phoneContainerInactive\"><img src=\"/images/Disabled.svg\"></div>"+"</div></div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"normalUpperLine\"></div><div class=\"normalTick\"></div></div><div class=\"normalStateTextContainer\"><div class=\"stateTextInactive\">"+e[3].status_message+"</div></div></div></div>"},getStateThreeTimeLine:function(e,a,t){var s=e[1].cta_info&&e[1].cta_info.value?"<div class=\"stateThreeBillActive\"><img src=\"/images/bill generated.svg\" download></div>":"<div class=\"stateThreeBillInactive\"><img src=\"/images/Disabled copy.svg\"></div>",i="<div class=\"subStateText\" id=\"de_info_msg\">"+e[2].message+"</div>",o=null==t?"":t,r=null!=t||""!=t?"<div class=\"phoneContainerActive\" id=\"de_info_num\"><a href=tel:+"+o+"><img src=\"/images/bill generated copy.svg\"></a></div>":"<div class=\"phoneContainerInactive\"><img src=\"/images/Disabled.svg\"></div>";return"<div class=\"container\"><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"successTick\"><img src=\"/images/checked.png\")></div><div class="+li_fn.showLongMessage(e[0].message)+"></div></div><div class=\"firstStateTextContainer\"><div class=\"stateText\">"+e[0].status_message+"</div><div class=\"subStateText\">"+e[0].message+"</div></div></div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"successUpperLine\"></div><div class=\"successTick\"><img src=\"/images/checked.png\")></div><div class="+li_fn.showLongMessage(e[1].message)+"></div></div><div class=\"secondStateTextContainer\"><div class=\"stateText\">"+e[1].status_message+"</div><div class=\"subStateText\">"+e[1].message+"</div>"+a+s+"</div>"+"".concat(!e[1].eg_message?"":"<div class=\"eg-message\">".concat(e[1].eg_message,"<img src=\"/images/information@3x.png\" class=\"info\"></div>"))+"</div><div class=\"concentricStateBar\"><div class=\"tickimageLineContainer\"><div class=\"concentricUpperLine\"></div><div class=\"circle-ripple\"></div><div class="+li_fn.showLongMessageTwo(e[2].message)+"></div></div><div class=\"concentricStateTextContainer\"><div class=\"stateText\">"+e[2].status_message+"</div>"+i+r+"</div></div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"normalUpperLine\"></div><div class=\"normalTick\"></div></div><div class=\"normalStateTextContainer\"><div class=\"stateTextInactive\">"+e[3].status_message+"</div></div></div></div>"},getStateFourTimeLine:function(e,a){var t=e[1].cta_info&&e[1].cta_info.value?"<div class=\"stateFourBillActive\"><img src=\"/images/bill generated.svg\" download></div>":"<div class=\"stateFourBillInactive\"><img src=\"/images/Disabled copy.svg\"></div>",s=e[2].cta_info&&e[2].cta_info.value?"<div class=\"phoneContainerActive\"><a href=tel:+"+e[2].cta_info.value+"><img src=\"/images/bill generated copy.svg\"></a></div>":"<div class=\"phoneContainerInactive\"><img src=\"/images/Disabled.svg\"></div>";return"<div class=\"container\"><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"successTick\"><img style=\"background:inherit;\" src=\"/images/checked.png\")/></div><div class="+li_fn.showLongMessage(e[0].message)+"></div></div><div class=\"firstStateTextContainer\"><div class=\"stateText\">"+e[0].status_message+"</div><div class=\"subStateText\">"+e[0].message+"</div></div></div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"successUpperLine\"></div><div class=\"successTick\"><img src=\"/images/checked.png\")></div><div class="+li_fn.showLongMessage(e[1].message)+"></div></div><div class=\"secondStateTextContainer\"><div class=\"stateText\">"+e[1].status_message+"</div><div class=\"subStateText\">"+e[1].message+"</div>"+t+a+"</div>"+"".concat(!e[1].eg_message?"":"<div class=\"eg-message\">".concat(e[1].eg_message,"<img src=\"/images/information@3x.png\" class=\"info\"></div>"))+"</div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"successUpperLine\"></div><div class=\"successTick\"><img src=\"/images/checked.png\")></div><div class="+li_fn.showLongMessage(e[2].message)+"></div></div><div class=\"secondStateTextContainer\"><div class=\"stateText\">"+e[2].status_message+"</div><div class=\"subStateText\">"+e[2].message+"</div>"+s+"</div></div><div class=\"concentricStateBar\"><div class=\"tickimageLineContainer\"><div class=\"concentricUpperLine\"></div><div class=\"circle-ripple\"></div></div><div class=\"concentricStateTextContainer\"><div class=\"stateText\">"+e[3].status_message+"</div><div class=\"subStateText\">"+e[3].message+"</div></div></div></div>"},getStateFiveTimeLine:function(e,a){var t=e[1].cta_info&&e[1].cta_info.value?"BillContainerActive":"BillContainerInactive",s=e[2].cta_info&&e[2].cta_info.value?"phoneContainerActive":"phoneContainerInactive";return"<div class=\"container\"><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"unSuccessTick\"><img src=\"/images/order rejected cross.svg\"></div><div class=\"normalLowerLine\"></div></div><div class=\"firstStateTextContainer\"><div class=\"stateText\">"+e[0].status_message+"</div></div></div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"normalUpperLine\"></div><div class=\"normalTick\"></div><div class=\"normalLowerLine\"></div></div><div class=\"secondStateTextContainer\"><div class=\"stateTextInactive\">"+e[1].status_message+"</div>"+a+"<div class="+t+"></div></div>"+"".concat(!e[1].eg_message?"":"<div class=\"eg-message\">".concat(e[1].eg_message,"<img src=\"/images/information@3x.png\" class=\"info\"></div>"))+"</div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"normalUpperLine\"></div><div class=\"normalTick\"></div><div class=\"normalLowerLine\"></div></div><div class=\"secondStateTextContainer\"><div class=\"stateTextInactive\">"+e[2].status_message+"</div><div class="+s+"></div></div></div><div class=\"stateBar\"><div class=\"tickimageLineContainer\"><div class=\"normalUpperLine\"></div><div class=\"normalTick\"></div></div><div class=\"normalStateTextContainer\"><div class=\"stateTextInactive\">"+e[3].status_message+"</div></div></div></div>"},getShipmentHeader:function(e){return"<div class=\"headerContent\"><div class=\"shipmentHeaderImageContainer image\"><img src=\""+e.image+"\"></div><div class=\"shipmentMainMessage\">"+e.message+"</div></div>"},checkout:{sendCouponPopUpEventDismiss:function(e,a){var t=a?e.cart.coupon:e.data.cart.coupon;t?t:$(".cpn_code").html().trim();var s={Source:"Purchase","Total Amount":a?+e.cart.subtotal:+e.data.cart.subtotal,coupon_name:t,coupon_type:a?e.cart.coupon_type:fn.getterLS("coupon_type"),Status:e.status,Message:e.message,hub_id:+fn.hubId,City:fn.cityName,discount:a?+e.cart.discount:+e.data.cart.discount,licious_wallet_amount:+$(".L_wallet").text(),auto_renewal:fn.getAutoRenewalType(),enrolment_type:meatopia_data.getDataByKeyName("enrolment_type"),meatopia_plan:meatopia_data.getDataByKeyName("selected_plan"),click_source:meatopia_data.getDataByKeyName("click_source"),pop_up_action:a?"Proceed":"Dismiss",pop_up_source:"loyalty"===$(".order").attr("payFor")?"Direct":"Cart"};fn.msite.sendAnalyticsData("auto_renew_coupon_popup",_objectSpread(_objectSpread({},s),{source:"loyalty"}))},handlePayOptionDisplay:function(e,a){!e&&(fn.getAutoRenewalFlag()||window.location.href.includes("subscription"))?(a.addClass("grayed"),a.attr("data-isactive",!1)):a.removeClass("grayed")},populateBillDetailsfromWallet:function(){navigator.userAgent.includes("phonepe-webview")||li_fn.payment.liciousWallet().then(function(e){"success"==e&&li_fn.payment.selectLiciousWalletOnLoad()})},cancel_order:{checkIfCancelOrderEnabled:function(e){return!(!e||!e.enable)},populateCancelOrderFields:function(e,a){var t=e.order_cancellation_meta,s=e.enable,i=e.is_visible,o=t.disable_cancel_description;$(".thirdLine .desc_text").html(o),i?($(".cancle_btn_div .cancel_btn").removeClass("cancle_btn_disabled"),$(".cancle_btn_div .cancel_btn .text_span").removeClass("text_span_disabled")):($(".cancle_btn_div .cancel_btn").addClass("cancle_btn_disabled"),$(".cancle_btn_div .cancel_btn .text_span").addClass("text_span_disabled")),5==a?($(".newOrderStatusFullContainer .newOrderStatusContainer").hide(),$(".cancle_btn_div").hide(),$(".addrDeliveryContainer .addr_div").css("width","100%"),$(".firstLine").css("width","100%")):($(".newOrderStatusFullContainer .newOrderStatusContainer").show(),$(".cancle_btn_div").show()),!!o&&s&&5!=a&&$(".thirdLine").show(),li_fn.checkout.cancel_order.populateCancelReasonPopup(t)},populateCancelReasonPopup:function(e){if(!$(".cancel_pop_up_container").hasClass("show")){var a=e.title,t=e.sub_title,s=e.description,i=e.Cancellation_reason;if($(".cancel_popup-line .order_cancel_header").html(a),$(".cancel_pop_up_order .reason_title").html(t),void 0!==i&&0!=i.length){var o=$(".reasons"),r="";i.forEach(function(e,a){r+="                            \n            <div class=\"reason\">\n              <div>\n                  <input class=\"radio-custom\" name=\"radio-group\" type=\"radio\" id=\"radio_".concat(a,"\" value=\"").concat(e,"\">\n                  <label for=\"radio_").concat(a,"\" class=\"radio-custom-label\">").concat(e,"</label>\n              </div>\n            </div>")}),o.html(r)}navigator.userAgent.includes("phonepe-webview")||$(".orange_text").html(s)}},populateRefundToast:function(e){if(!navigator.userAgent.includes("phonepe-webview")&&!!e){var a=e.refund_info,t=e.weblink,s=e.is_visible;$(".refund_toast .refund_text").html(a),!t||($(".refund_toast .link_text").attr("href",t),$(".refund_toast .link_text").show()),s?$(".refund_toast_container").show():$(".refund_toast_container").hide()}}},validateLoyaltyEligibilitySlotPage:function(e){return null!==e&&"undefined"!=typeof e&&0<e.length},displayLoyaltyInCart:function(e){var a=document.createElement("div");a.className+="cart-loyalty-container",a.innerHTML="\n        <div class=\"banner-cross-container\" plan_id = ".concat(e[0].subprogram_id,">\n          <img src=\"/images/licious-meatopia-logo.svg\" class=\"licious-img\"/>\n          <img src=\"/images/meatopia-golden-cross.svg\" class=\"cross-mark\"/>\n        </div>\n        <div class=\"cart-loyalty-info-container\">\n          <span class=\"plan_name\">").concat(e[0].subprogram_name,"</span>\n          <span class=\"cost_final\">\u20B9 ").concat(e[0].discounted_price,"</span>\n          <span class=\"cost_discount\">").concat(0>=e[0].price-e[0].discounted_price?"":"\u20B9 ".concat(e[0].price),"</span>\n\n          <span class=\"right-content\">\n              CHANGE PLAN\n              <img class=\"drop-down\" src=\"/images/dropdown1_icon.png\">\n          </span>\n              \n        </div>\n        "),$(".cart-card ul.order-items").prepend(a)},validateLoyaltyEligibilityCartPage:function(e,a){var t=!1;return null!==a&&"undefined"!=typeof a&&0<a.length&&(t=!0),t},handleMapConditions:function(){$(".newShipmentHeaderContainer").html("<div iYd=\"map\"></div>"),$(".arrivalInfoBlade").show(),$("#map").show(),localStorage.setItem("Poll",!0),li_fn.checkout.getTrackStatus()},validateLiveTrack:function(e){return!!(e&&e.address_info&&e.hub_info)},showMap:function(e,a){function t(){var a=u.getPosition(),t=h.getPosition(),i=map.getProjection(),r=i.fromLatLngToPoint(a),l=i.fromLatLngToPoint(t),p=new n(l.x-r.x,l.y-r.y),e=new n(p.x/2,p.y/2),m=new n(p.y,-p.x),o=new n(e.x+s*m.x,e.y+s*m.y),c="M 0,0 q "+o.x+","+o.y+" "+p.x+","+p.y,y=map.getZoom(),_=1/Math.pow(2,-y),g={path:c,scale:_,strokeWeight:2,fillColor:"none",strokeOpacity:1};v?v.setOptions({position:a,icon:g}):v=new d({position:a,clickable:!1,icon:g,zIndex:0,map:map})}console.log("map show");var s=.3,i=google.maps.Map,o=google.maps.LatLng,r=google.maps.LatLngBounds,d=google.maps.Marker,n=google.maps.Point,l=new o(e.lat,e.lng),c=new o(a.lat,a.lng),p=new r;p.extend(l),p.extend(c),map=new i(document.getElementById("map"),{center:p.getCenter(),mapTypeControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,zoomControl:!1}),map.fitBounds(p),map.setOptions({dragabble:!1});var u=new d({position:l,draggable:!1,map:map,icon:"/images/location home icon.svg"}),h=new d({position:c,draggable:!1,map:map,icon:"/images/pin location.svg"}),v;map.setOptions({draggable:!1});var m=new google.maps.InfoWindow({content:"<div>Delivering nearby</div>",pixelOffset:new google.maps.Size(0,85)});google.maps.event.addListener(m,"domready",function(){$(".gm-ui-hover-effect").hide()}),google.maps.event.addListener(map,"projection_changed",t),google.maps.event.addListener(map,"zoom_changed",t),google.maps.event.addListener(u,"position_changed",t),google.maps.event.addListener(h,"position_changed",t),m.open(map,h)},renderTrackLiveView:function(e){$("#map").show(),$(".arrivalinfo").show(),$(".arrivalimage").show(),null==e.de_name?localStorage.setItem("de_name",""):localStorage.setItem("de_name",e.de_name),null==e.badge_type?localStorage.setItem("deliveryspeed",""):localStorage.setItem("deliveryspeed",e.badge_type),null==e.eta?localStorage.setItem("eta",""):localStorage.setItem("eta",e.eta),$(".arrivalinfo .arrivingtext").html(e.eta),$(".arrivalimage .arrivingbadge").html("<img src="+e.badge_image+" style=\"height: 29px\">"),null!==e.track_link&&e.live_track_enabled&&($(".arrivalInfoBlade").show(),$(".arrivalInfoBlade .arrivingBadge").html("<img src="+e.badge_image+">"),$(".arrivalInfoBlade .arrivingText").html(e.eta),$(".arrivalinfo").hide(),$(".arrivalimage").hide(),$(".newShipmentHeaderContainer").hide(),$("#map").hide(),$("#webView").show(),$("#webView").css("margin-top","45px"),$("#webView").attr("src",""),$("#webView").attr("src",e.track_link))},renderFailTimerPayButtonView:function(e){var a=new Date().getTime(),t=new Date(a+1e3*+e.timer);a=new Date().getTime();var s=t-a;if(0<s)var i=setInterval(function(){var e=Math.floor;a=new Date().getTime(),s=t-a;var o=e(s%3600000/60000),r=e(s%60000/1e3);10>o&&(o="0"+o),10>r&&(r="0"+r),$(".count-minutes").html(o),$(".count-seconds").html(r),0>s&&($(".count-minutes").html("00"),$(".count-seconds").html("00"),$(".place-order").length&&$(".place-order").remove(),$(".timerContainer").length&&$(".timerContainer").remove(),location.reload(),clearInterval(i))},1e3);var o="<div class=\"place-order\"><div class=\"total style-bold\"><span class=\"pay-text style-bold\">Total : </span> &#8377; <span class=\"style-bold pay-amount\">"+e.total+"</span></div><button class=\"order\"><div class=\"order-text\"><span class=\"style-bold font-15 placeorder\">Pay</span></div></button></div>";0<s&&($(".new-payment-failed").append("<div class=\"container\"><div class=\"payment-failed-image\"><img src=\"https://d2407na1z3fc0t.cloudfront.net/Banner/alert-pay.png\"/></div><div class=\"payment-failed-text-container\"><div class=\"payment-failed-title\">Payment Unsuccessfull !!</div><div class=\"payment-failed-desc\"><div>Your payment for order could not be completed,</div><span>Please retry your payment within 7 mins.</span></div></div>"),$(".order-status-wrapper").append(o),$(".newTimerConatiner").append("<div class=\"timer\"><div class=\"timer-image\"><img src=\"https://d2407na1z3fc0t.cloudfront.net/Banner/watch-timer.png\"/></div><div class=\"countContainer\"><div class=\"count count-minutes\"/><div class=\"minute\">Minutes</div></div><div class=\"countContainer\"><div class=\"count count-seconds\"/><div class=\"second\">Seconds</div></div><div class=\"retry-note\"><div><b>Retry your</b> <span><b>payment within 7 mins</b></span></div>")),$(".order").on("click",function(){window.location.href="/customer/payments?orderId="+e.parent_order_id})},renderUnknownBanner:function(){$(".newOrderStatusFullContainer .waiting-loader-container").append("<div><div class=\"loader-dot\"><span /><span /><span /><span /><span /></div></div><div class=\"bankText\">Meanwhile we are checking with bank for <span>the payment confirmation</span></div>"),$(".contact-list").hide(),$(".shipment-wrapper").hide()},reinitiatePayment:function(e){return fn.ajaxForm({payments:e.payments,order_id:e.orderId,total:e.total,is_shipment:e.is_shipment,is_auto_renewal:fn.getAutoRenewalFlag()},"POST","/customer/reinitiate-payment")},createLoyaltyOrder:function(e){return fn.ajaxForm({payments:e.payments,total:e.total,loyalty_item:e.loyalty_item,is_renewal:e.is_renewal},"POST","/loyalty/loyalty-pay")},handleAutoRenewPayPage:function(){$(".payment-break-down")&&$(".payment-break-down").length&&$(".payment-break-down").remove(),$(".place-order")&&$(".place-order").length&&$(".place-order").hide(),$(".pay_btn_sub").show()},createSubscriptionOrder:function(e){return fn.ajaxForm({payments:e.payments,total:e.total,loyalty_item:e.loyalty_item},"POST","/loyalty/loyalty-subscribe")},createOrder:function(e){return fn.ajaxForm({address_id:localStorage.getItem("default_addr_id"),payments:e.payments,coupon:localStorage.getItem("coupon_used"),total:e.total,is_auto_renewal:fn.getAutoRenewalFlag(),browserFingerPrint:browserFingerPrint,screen_width:screen.width,screen_height:screen.height},"POST","/customer/create-order-revamp")},getPaymentStatus:function(e){return fn.ajaxForm({orderId:e},"GET","/customer/payment-status").done(function(e){e=JSON.parse(e);for(var a="",t=e.data.payment,s=0;s<t.length;s++){if("unknown"===t[s].status.toLowerCase()){a="unknown";break}if("failure"===t[s].status.toLowerCase()){a="failure";break}"success"===t[s].status.toLowerCase()&&(a="success")}if("success"===a)location.reload();else if("failure"===a)location.reload();else if("unknown"===a){if($(".newOrderStatusFullContainer .waiting-loader-container").hide(),$(".contact-list").hide(),$(".shipment-wrapper").hide(),$(".not-confirmed").length)return $(".not-confirmed").show(),e;return $(".newOrderStatusFullContainer .paymenttextPlaceholder").append("<div class=\"not-confirmed\"><div class=\"container\"><div class=\"not-confirmed-image\"><img src=\"/images/info-img.png\" /></div><div class=\"not-confirmed-text-container\"><div class=\"not-confirmed-title\">Payment not confirmed!</div><div class=\"not-confirmed-desc\">Please comeback after 15 mins, while we try to reconsile with your bank</div></div></div></div>"),e}})},trackDetail:function(e){$("#webView").length&&$("#webView").hide(),$(".arrivalInfoBlade").hide(),$("#map").hide(),$(".arrivalinfo").hide(),$(".arrivalimage").hide(),fn.ajaxForm({key:e},"POST","/customer/li-track-order").done(function(e){var a=JSON.parse(e.data),t=a.data.shipments,s="";if("undefined"!=typeof t&&0<t.length&&t.map(function(e){s=e.customer_key}),"success"==a.statusMessage){if(li_fn.flushOldContents(),$(".newShipmentSlot .shipmentSlotContainer").html(""),$.map(t,function(e,a){var t="<div class=\"shipmentActiveTextContainer\" ><div class=\"shipmentText order_"+e.order_id+"\"index=\""+a+"\" data-order_id=\""+e.order_id+"\">"+e.shipment_messages.label+"</div></div>";$(".newShipmentSlot .shipmentSlotContainer").append(t)}),""!=e.def_id){$(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText.order_"+e.def_id).addClass("active");var i=t.filter(function(a){return a.order_id==e.def_id});invoice_order_id=i[0].order_id,invoice_order_date=i[0].order_processing_date,li_fn.checkout.renderTrackData(a,i[0],e.def_id),3==i[0].state_id&&(""==s?alert("something went wrong"):li_fn.handleMapView(s))}$(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText").on("click",function(i){i.stopImmediatePropagation();var e=$(this).attr("data-order_id"),o=t.filter(function(a){return a.order_id==e});invoice_order_id=o[0].order_id,invoice_order_date=o[0].order_processing_date,localStorage.setItem("analytics_shipment_id",o[0].order_id),$(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText").removeClass("active"),$(".arrivalInfoBlade").hide(),$("#map").hide(),$("#webView").hide(),$(".arrivalinfo").hide(),$(".arrivalimage").hide(),$(".newShipmentHeaderContainer").show(),li_fn.checkout.renderTrackData(a,o[0],e),3==o[0].state_id&&(""==s?alert("something went wrong"):li_fn.handleMapView(s)),localStorage.setItem("state_id",o[0].state_id),localStorage.setItem("Poll",!0)}),li_fn.handleProductBarClick()}else window.location.href="/?action=login"})},pushEEBeginCheckout:function(e){var a={};try{var t=e.products,s=e.exotic,i=[],o=Array.isArray(t)?t.reduce(function(e,a,t){var s=a.product_id,i=a.product_name,o=a.category_name,r=a.base_price,d=a.quantity,t=t;return e.push({item_id:s,item_name:i,item_category:o,price:r,quantity:d,currency:"INR",index:t}),e},[]):[],r=Array.isArray(s)?s.reduce(function(e,a,t){var s=a.product_id,i=a.product_name,o=a.category_name,r=a.base_price,d=a.quantity,t=t;return e.push({item_id:s,item_name:i,item_category:o,price:r,quantity:d,currency:"INR",index:t}),e},[]):[];if(i=o.concat(r),a={checkout_step:"quick_checkout"===fn.msite.getCheckoutFlowType()?"2.0":"1.0",item_list:i},fn.msite.branchIO.addEvent("begin_checkout",a),window.dataLayer){var d=window.dataLayer;d.push({event:"begin_checkout",ecommerce:{checkout:{actionField:{step:1,option:"cart"},products:i}}})}}catch(t){fn.msite.branchIO.branchLogErr(t,a,"begin_checkout")}},getCartData:function(){return new Promise(function(e,a){fn.ajaxForm({},"GET","/customer/li-get-cart").done(function(a){var t=JSON.parse(a);if(e(t),200==t.statusCode){$(".cart-card ul.order-items").html(""),$(".cart-wrapper .delivery-free").css("display","none"),t.data.hasOwnProperty("overdue")&&!0==t.data.overdue.status&&0<t.data.overdue.amount&&($(".cart-wrapper .extragrammage-popup").text(t.data.overdue.message||""),$(".cart-wrapper .extragrammage-popup").css("display","block"),setTimeout(function(){$(".cart-wrapper .extragrammage-popup").css("display","none")},5e3));var s=new HomePageBannerHandler;if(s.getHomePageAPIData().done(function(e){var a=JSON.parse(e);fn.setMeatopiaData(a),s.handleBannerRenderCases(a.data,"cart"),a.data.is_subscribed||s.renderPopupBenefits(a.data),s.showAutoRenewalSection(a.data.auto_renewal),fn.populateLoyaltyBannerData(a.data)}),li_fn.checkout.validateLoyaltyEligibilityCartPage(t.data.isLoyaltyCustomer,t.data.loyalty_item)){if($(".cart_loyalty_banner").hide(),$(".cart_loyalty_default_banner_placeholder").hide(),0<$(".buy_plan button").length&&$(".buy_plan button").attr("modify_plan","true"),t.data.hasOwnProperty("loyalty_item")&&null!==t.data.loyalty_item){fn.setLSLoyaltyData(t.data.loyalty_item);for(var o=document.querySelectorAll(".loyalty_plan"),r=0;r<o.length;r++)o[r].value.toString()===t.data.loyalty_item[0].subprogram_id.toString()?(o[r].checked=!0,o[r].parentNode.parentNode.parentNode.style.border="solid 1px #e41d36"):(o[r].checked=!1,o[r].parentNode.parentNode.parentNode.style.border="none")}li_fn.checkout.displayLoyaltyInCart(t.data.loyalty_item)}else $(".cart_loyalty_banner").show(),$(".cart-loyalty-container").hide(),$(".cart_loyalty_default_banner_placeholder").show();t.data.isLoyaltyCustomer.status&&(t.data.hasOwnProperty("loyalty_item")&&null!==t.data.loyalty_item&&fn.setLSLoyaltyData(t.data.loyalty_item),localStorage.setItem("loyalty_olddelivery_charge",t.data.cart_subtotal-t.data.cart_total),localStorage.setItem("oldcart_value",t.data.cart_total));var d=t.data.exotic?t.data.exotic.concat(t.data.products):t.data.products,n=[],l=[],c=[];$.map(d,function(e){l.push(e.product_name),n.push(e.product_id),c.push(+e.quantity)}),$(".cart-payment-charges").html(""),$(".bill-details").show(),$(".bd-contents ul").html(""),$.map(t.data.cart_order_charges,function(e){("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&($(".delivery-fee").html("Delivery fee: \u20B9 "+e.value),localStorage.setItem("loyalty_delivery_charge",e.value.toString()));var a="",t=void 0===e.message?"":"<span class=\"message\">"+e.message+"</span>";"discount"!=e.key.toLowerCase()&&"wallet"!=e.key.toLowerCase()&&"liciouswallet"!=e.key.toLowerCase()&&("total"===e.key.toLowerCase()?(localStorage.setItem("loyalty_cart_value",e.value.toString()),$(".slot-summary-wrapper .amount span").html("Total: &#8377; "+e.value),a="<li ><div class=\"seperator\"></div></li><li><div class=\"slot-key-total\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"slot-value-total\"> \u20B9 "+ +e.value+"</div></li>"):(t=("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&0>=e.value?"<span class=\"message\" style=\"color:#417505\">"+e.message+"</span>":t,a="<li><div class=\"slot-key\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"slot-value\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</div></li>"),$(".bd-contents ul").append(a))}),localStorage.setItem("egg_flag","false"),localStorage.setItem("product_quantity",c);if(localStorage.setItem("prod_data",JSON.stringify({pr_name:l,pr_ids:n,pr_qty:c})),0<t.data.messages.length){var p=li_fn.checkout.sortJSONObject(t.data.messages);localStorage.setItem("saveamount",t.data.discount),$.map(p,function(e){e&&"free_delivery"==e.condition&&($(".cart-wrapper .delivery-free").html(e.message),$(".cart-wrapper .delivery-free").css("display","block"))}),"success"==p[0].style&&($(".success-message").html(p[0].message),$(".success-message").css("display","block"),$(".success-message").css("border","1px solid #417505"),$(".success-message").css("color","#417505"),""!=localStorage.getItem("select_address")&&"undefined"!=localStorage.getItem("select_address")&&$(".proceed-cart-summary").prop("disabled",!1)),"warning"==p[0].style&&($(".success-message").html(p[0].message),$(".success-message").css("display","block"),$(".success-message").css("border","1px solid #d47015"),$(".success-message").css("color","#d47015"),$(".proceed-cart-summary").prop("disabled",!0),localStorage.setItem("egg_flag","true"))}if(localStorage.getItem("select_address")&&""!=localStorage.getItem("select_address")&&"undefined"!=localStorage.getItem("select_address")&&"true"!=localStorage.getItem("egg_flag")?$(".proceed-cart-summary").prop("disabled",!1):$(".proceed-cart-summary").prop("disabled",!0),$(".cart-summary-wrapper .total-amt span").html("&#8377; "+t.data.cart_subtotal),li_fn.checkout.renderCartProduct(d),li_fn.checkout.renderUnavailableItem(t.data.oss_products),li_fn.checkout.removeCartItem($(".item-remove"),t),fn.msite.addCartCheckout($(".add-one"),"cart"),fn.msite.removeCartCheckout($(".remove-one"),"cart",t),checkoutobj={Source:"Checkout_Proceedshipment","Cart Value":t.data.cart_total,"City Name":fn.cityName,"Hub ID":+fn.hubId,"Product Name":l,"Saved Value":+localStorage.getItem("saveamount"),Quantity:c,"Product ID":n},localStorage.setItem("checkoutstarted",JSON.stringify(checkoutobj)),!0==t.data.delivery_free){var m={"Product Name":l,Quantity:c,"Cart Value":t.data.cart_total,"Delivery Charge":t.data.cart_subtotal-t.data.cart_total,"Saved Amount":(+localStorage.getItem("saveamount")).toString(),"City Name":fn.cityName,Source:"CartView","Hub ID":+fn.hubId};clevertap.event.push("Cart_FreeDel_Apply",m),ga("send",{hitType:"event",eventCategory:"CartView",eventAction:"Cart_FreeDel_Apply",eventLabel:JSON.stringify(m)})}else{var m={"Product Name":l,Quantity:c,"Cart Value":t.data.cart_total,"Delivery Charge":t.data.cart_subtotal-t.data.cart_total,"Saved Amount":(+localStorage.getItem("saveamount")).toString(),"City Name":fn.cityName,Source:"CartView","Hub ID":+fn.hubId};clevertap.event.push("Cart_FreeDel_Remove",m),ga("send",{hitType:"event",eventCategory:"CartView",eventAction:"Cart_FreeDel_Remove",eventLabel:JSON.stringify(m)})}localStorage.setItem("cart_withoutshipping",t.data.cart_total),li_fn.checkout.proceedShipment(),fn.setLsProducts(t.data.products,t.data.exotic)}else 202==t.statusCode&&($(".cart-card ul.order-items").html(""),li_fn.checkout.checkoutMsg("empty"," "),$(".proceed-cart-summary").prop("disabled",!0))}).fail(function(){$(".proceed-cart-summary").prop("disabled",!0),li_fn.checkout.checkoutAlert("api_fail","Something went wrong. Please retry"),a()})})},proceedShipment:function(){$(".proceed-cart-summary").on("click",function(a){sessionStorage.setItem("isQuickCheckoutFlow",!1),a.stopImmediatePropagation(),localStorage.setItem("back_page","cart"),fn.msite.proceedShipmentEvent();var e=JSON.parse(localStorage.getItem("products"));if(fn.localStorageCheck(e)){var t={products:e.normal,exotic:e.exotic};li_fn.checkout.pushEEBeginCheckout(t)}setTimeout(function(){window.location="/customer/cart-summary"},1500)})},renderCartProduct:function(e){if(0<e.length){var a=function(e){return""==e.pieces?e.weight:e.pieces};$.map(e,function(e,t){var s=e.offer_discount&&0<e.discount?"<span class = \"discounted-price\">&#8377; "+parseFloat(e.base_price).toFixed(0)+"</span><span class = \"base-price\">&#8377; "+parseFloat(e.base_price+e.discount/e.quantity).toFixed(0)+"</span>":"<span class = \"discounted-price\"> &#8377; "+parseFloat(e.base_price).toFixed(0)+"</span>",i=e.product_id,o="<li class=\"product-list prid_"+i+" \" data-prid=\""+e.product_id+"\" ><div class=\"item-detail\"><div class=\"serial\">"+(t+1)+"</div><div class=\"name\">"+e.product_name+"</div><span class=\"cross item-remove\" data-prid=\""+e.product_id+"\" data-is_combo_child=\""+e.is_combo_child+"\" data-description=\""+e.combo_pop_up_messages.description+"\" data-title=\""+e.combo_pop_up_messages.title+"\" data-alert_message=\""+e.combo_pop_up_messages.alert_message+"\"><img src=\"/images/cart-delete.png\"></span></div><div class=\"item-info\"><div class=\"item-price\"><span class=\"quantity\">"+a(e)+"</span>"+s+"</div><div class=\"item-count\"><span class=\"icon icon-minus remove-one\" data-prid = \""+e.product_id+"\" data-stock = \""+e.stock+"\" data-is_combo_child=\""+e.is_combo_child+"\" data-description=\""+e.combo_pop_up_messages.description+"\" data-title=\""+e.combo_pop_up_messages.title+"\" data-alert_message=\""+e.combo_pop_up_messages.alert_message+"\"></span><span class=\"item-number total-count\" data-count=\""+e.quantity+"\"> "+e.quantity+" </span><span class=\"icon icon-plus add-one\" data-prid = \""+e.product_id+"\" data-stock = \""+e.stock+"\" data-prname=\""+e.product_name+"\" data-discount=\""+e.discount+"\" data-offer_discount=\""+e.offer_discount+"\"  data-offer_type=\""+e.offer_type+"\" ></span></div></div></li>";$(".cart-card ul.order-items").append(o)})}},renderUnavailableItem:function(e){0<e.length&&($(".cart-card").append("<ul class = \"unavailable-item\"></ul>"),$(".cart-card .unavailable-item").append("<div class=\"item-header\">Items unavailable</div>"),$.map(e,function(e){var a="<li class=\"items-list\"><div class=\"description\"><span class=\"name\">"+e.product_name+"</span><span class=\"quantity\">Qty:"+e.quantity+"</span> </div></li>";$(".cart-card").find("ul.unavailable-item").append(a)}))},crossSellProduct:function(){var e=Math.round;fn.ajaxForm({},"GET","/customer/li-cross-sell").done(function(a){var t=JSON.parse(a);if("success"==t.status){var s=function(e){return""==e.pieces?e.net:e.pieces+" Pieces"},i=function(a,t,s,i){return"percentage"==s?e(a-a*t/100):"flat"==s?e(a-t):"nooffer"==s?0<i?e(a-a*i/100):a:a},o=function(e,t,s){return(t=0<s?s:t,"percentage"==e)?t+"% Off":"flat"==e?"&#8377; "+t+" Off":"delivery"==e?($(".deliver_bar").html("<span class=\"text\">"+a.delivery_free_message+"</span>"),"Free Delivery"):"nooffer"==e?0<s?s+"% Off":void 0:void 0},r=$(".cross-sell-wrapper");r.find(".new-offer-line .line-desc").html(t.title),$(".cross-sell-wrapper .cross-sell-card").html(""),0<t.data.length&&(r.addClass("show"),$.map(t.data,function(e,a){var r=i(e.base_price,e.crosssell.value,e.crosssell.type,e.base_discount),d="nooffer"==e.crosssell.type&&0>=e.base_discount?"hide":"show",n="nooffer"==e.crosssell.type&&0>=e.base_discount||"delivery"==e.crosssell.type?"hide":"show",l="<li class=\"item-card prid_"+e.crosssell.product_id+" parentid_"+e.crosssell.parent_product_id+"\"><div class=\"image\"><span class=\"offer_discount "+d+"\">"+o(e.crosssell.type,e.crosssell.value,e.rounded_base_discount)+"</span><img src=\""+e.pr_image+"\"></div><div class=\"item-desc\"><div class=\"item-name\"><span>"+e.merchandise_name+"</span></div><div class=\"add-item"+(2==e.slot_available?"-disabled":"")+"\" data-crosssellid=\""+e.crosssell.id+"\" data-prid=\""+e.crosssell.product_id+"\" data-offertype=\""+e.crosssell.type+"\" data-index = \""+a+"\" data-pr_name = \""+e.merchandise_name+"\" data-amount= \""+r+"\" data-msg=\""+t.delivery_free_message+"\"></div></div><div class=\"detail-item\"><div class=\"amount\"><span class=\"base-price "+n+"\">&#8377; "+e.base_price+"</span><span class=\"discounted-price\">&#8377; "+r+"</span></div><div class=\"quantity\"><span class=\"item-quantity\">"+s(e)+"</span></div></div></li>";$(".cross-sell-wrapper .cross-sell-card").append(l)}),li_fn.checkout.addCrossSellProduct($(".item-desc .add-item")))}})},addCrossSellProduct:function(e){e.on("click",function(a){a.stopPropagation(),$(this).prop("disabled",!0);var e=$(this).data("prid"),t=$(this).data("crosssellid"),s=$(this).data("offertype"),i=$(this).data("index"),o=$(this).data("pr_name"),r=$(this).data("amount"),d=$(this).attr("data-msg");fn.msite.showloader(),fn.msite.addToCart(e,"1",t).done(function(a){var t=JSON.parse(a);if("success"==t.status){$(".cross-sell-card").find(".prid_"+e).fadeOut(300,function(){$(this).remove(),1>$(".cross-sell-card").children(".item-card").length&&$(".cross-sell-wrapper").hide()}),"delivery"==s&&li_fn.checkout.checkoutMsg("warning",d),li_fn.checkout.getCartData();var o={Source:"CartView","Product Name":t.product.product_name,Discount:t.product.discount,"Offer Name":t.product.offer_type,"New Cart Value":+t.total,"Delivery Charge":+t.shipping_charge,"Saved Amount":"","is discounted item":t.product.offer_discount,"City Name":fn.cityName,"Hub ID":fn.hubId,"Position of item":i+1};clevertap.event.push("Add - Cross Sell",o);var r={"Product Name":t.product.product_name,Discount:t.product.discount,"Offer Name":t.product.offer_type,"New Cart Value":+t.total,"Delivery Charge":+t.shipping_charge,"Saved Amount":"","is discounted item":t.product.offer_discount,"City Name":fn.cityName,"Hub ID":fn.hubId,"Position of item":i+1};ga("send",{hitType:"event",eventCategory:"CartView",eventAction:"Cart_Addcrosssell",eventLabel:JSON.stringify(r)})}else li_fn.checkout.checkoutMsg("error",t.message)}).always(function(){fn.msite.hideloader(),$(".item-desc .add-item").prop("disabled",!1)})})},removeCartItemSuccess:function(e,a,t){fn.msite.showloader(),fn.msite.deleteFromCart(a).done(function(e){if(resp=JSON.parse(e),"success"==resp.status){var s="none"!=$(".overdue-popup").css("display");$(".order-items .product-list.prid_"+a).remove(),resp.show_popup&&fn.msite.showAlert("offer_modified",resp.web_popup_message),li_fn.checkout.getCartData().then(function(){0<+t&&(s?($(".combo-removal-msg").show(),$(".overdue-popup").hide(),setTimeout(function(){$(".combo-removal-msg").hide(),$(".overdue-popup").show()},5e3)):($(".combo-removal-msg").show(),setTimeout(function(){$(".combo-removal-msg").hide()},5e3)))})["finally"](function(){fn.msite.hideloader()})}}).always(function(){})},removeCartItem:function(a,e){a.on("click",function(t){t.stopImmediatePropagation();var s=$(this).data("prid"),i=$(this).data("is_combo_child"),o=$(this).data("title"),r=$(this).data("description"),d=$(this).data("alert_message");if(i){var n=fn.lsFindProduct(s);$(".combo-popup-header").html(o),$(".combo-popup-text").html(r),$(".action-yes").html("Remove"),$(".action-no").html("Don't remove"),$(".combo-popup").addClass("show"),$(".action-yes").unbind("click"),$(".action-yes").click(function(){$(".combo-popup").removeClass("show"),$(".combo-removal-msg").html(d),li_fn.checkout.removeCartItemSuccess(a,s,"1")}),$(".action-no").click(function(){if(!!e){var a={Source:"CartView","Product Name":n.product_name,Discount:+e.data.discount,"New Cart Value":+e.data.cart_total,"Delivery Charge":+e.data.shipping,"Saved Amount":"","is discounted item":n.offer_discount,"City Name":fn.cityName,"Hub ID":fn.hubId};clevertap.event.push("Cart_ComboModal_DontRemove",a)}$(".combo-popup").removeClass("show")}),$(".cross").click(function(){if(!!e){var a={Source:"CartView","Product Name":n.product_name,Discount:+e.data.discount,"New Cart Value":+e.data.cart_total,"Delivery Charge":+e.data.shipping,"Saved Amount":"","is discounted item":n.offer_discount,"City Name":fn.cityName,"Hub ID":fn.hubId};clevertap.event.push("Cart_ComboModal_DontRemove",a)}$(".combo-popup").removeClass("show")})}else li_fn.checkout.removeCartItemSuccess(a,s,"0")})},fetchAddress:function(){fn.ajaxForm({},"GET","/customer/li-get-address").done(function(e){var a=JSON.parse(e);if(!(200==a.statusCode))203==a.statusCode?($(".add-address").css("display","block"),localStorage.setItem("no_address",!0),localStorage.setItem("addr_value",!0),localStorage.setItem("select_address",""),$(".proceed-cart-summary").prop("disabled",!0)):$(".proceed-cart-summary").prop("disabled",!0);else if(0<a.data.address.length){$(".choose-address").css("display","block"),localStorage.setItem("no_address",!1),localStorage.setItem("addr_value",!1),localStorage.setItem("editbysave","");var t=localStorage.getItem("hub"),s=a.data.defaultaddress[0],i=a.data.defaultaddress[0];localStorage.setItem("select_address",i);var o=!1;""==i||"true"==localStorage.getItem("egg_flag")?$(".proceed-cart-summary").prop("disabled",!0):$(".proceed-cart-summary").prop("disabled",!1),$.map(a.data.address,function(e){e.address_id==i&&($(".choose-address").find(".address-desc .selected-addr").html(e.line1+", "+e.line2),o=!0,localStorage.setItem("default_addr_id",e.address_id),localStorage.setItem("default_address",fn.msite.getFormattedAddress(e)),localStorage.setItem("default_lat",e.lat),localStorage.setItem("default_lng",e.lng),$(".change-addr").attr("data-text","change"))}),!0==o?$(".change-addr").attr("data-text","change"):($(".change-addr").html("Choose Address"),$(".address-box").find(".delivery-addr").text("Shipping Address"),$(".change-addr").attr("data-text","choose"),$(".proceed-cart-summary").prop("disabled",!0),localStorage.setItem("default_addr_id",""),localStorage.setItem("default_address",""),localStorage.setItem("default_lat",""),localStorage.setItem("default_lng",""))}else $(".add-address").css("display","block"),localStorage.setItem("no_address",!0),localStorage.setItem("addr_value",!0),$(".proceed-cart-summary").prop("disabled",!0),localStorage.setItem("default_addr_id",""),localStorage.setItem("default_address",""),localStorage.setItem("default_lat",""),localStorage.setItem("default_lng","")}).fail(function(){$(".proceed-cart-summary").prop("disabled",!0),li_fn.checkout.checkoutAlert("api_fail","Something went wrong. Please retry")})},renderAddress:function(){fn.msite.showloader(),fn.ajaxForm({},"GET","/customer/li-get-address").done(function(e){var a=JSON.parse(e);200==a.statusCode&&0<a.data.address.length?($(".saved-address .all-addresses").html(""),$(".addr-confirm").prop("disabled",!1),$.map(a.data.address,function(e){var t=a.data.defaultaddress[0]==e.address_id?t="selected":t="";a.data.defaultaddress[0]==e.address_id&&(localStorage.setItem("default_addr_id",e.address_id),localStorage.setItem("default_address",fn.msite.getFormattedAddress(e)),localStorage.setItem("default_lat",e.lat),localStorage.setItem("default_lng",e.lng));var s=null==e.landmark?"":e.landmark;var i=""==t?i="disabled=true":i="",o="<li class=\"list "+t+"\" ><div class=\"address-container\" data-lat=\""+e.lat+"\" data-lng=\""+e.lng+"\" data-addrid=\""+e.address_id+"\" data-pincode=\""+e.pincode+"\" data-hub_id=\""+e.hub_id+"\" data-city=\""+e.city+"\"><div class=\"select-btn \"><input type=\"radio\" id=\""+e.address_id+"\" name=\"address "+e.address_id+"\"></div><div class=\"select-addr \"><h4 class=\"cust-name\">"+e.line1+"</h4><p>"+e.line2+"</p><p>"+s+"</p><p>"+(e.city+", "+e.pincode)+"</p><p class=\"cell-no\">Mobile Number : "+e.contact+"</p></div></div><div class=\"edit-delete\"><button class=\"edit-btn style-bold\" data-addrid=\""+e.address_id+"\" "+i+">Edit</button><button class=\"delete-btn style-bold\" "+i+" data-custKey=\""+e.customer_key+"\" data-addressId=\""+e.address_id+"\">Delete</button></div></li>";$(".saved-address .all-addresses").append(o)}),$(".list .address-container").on("click",function(){$(".all-addresses .list").removeClass("selected"),$(this).parent().addClass("selected"),$(".edit-btn").attr("disabled",!0),$(".delete-btn").attr("disabled",!0),$(this).parent().find(".edit-btn").removeAttr("disabled"),$(this).parent().find(".delete-btn").removeAttr("disabled")})):203==a.statusCode&&($(".addr-confirm").hide(),$(".saved-address .all-addresses").html(""),$(".addr-confirm").prop("disabled",!0),$(".no-address").addClass("show")),li_fn.checkout.deleteAddress(),li_fn.checkout.saveAddress(),li_fn.checkout.editAddress(),li_fn.checkout.selectAddress()}).always(function(){fn.msite.hideloader()})},deleteAddress:function(){$(".delete-btn").on("click",function(a){a.stopImmediatePropagation(),fn.msite.showloader();var e=$(this).attr("data-addressid");fn.ajaxForm({address_id:e},"POST","/customer/li-delete-address").done(function(e){var a=JSON.parse(e);if("success"==a.statusMessage){fn.msite.hideloader(),li_fn.checkout.renderAddress();var t=$(".all-addresses").find(".list").length;li_fn.checkout.eventAddressPage("Delete Address",t-1,"Checkout_DeleteAddress")}}).always(function(){fn.msite.hideloader()})})},locationValidate:function(e,a,t){fn.ajaxForm({lat:e.lat,lng:e.lng},"POST","/locationValidate").done(function(s){if($(".address_error").html(""),s=JSON.parse(s),"success"==s.status){$(".address_error").hide(),$(".loc-error").hide(),document.getElementById("save-addr").disabled=!1,$("#confirmed-save-addr").prop("disabled",!1),fn.msite.storeAddresses(e.lat,e.lng,a,t);var i=JSON.parse(localStorage.getItem("recentSearches")||!1)||[],o=$(".recent-data");o.html("");var r=0;i.map(function(e){3>r&&(r++,o.append("<div class=\"recent-search-item\" data-lat = \""+e.lat+"\" data-lng = \""+e.lng+"\" data-loc = \""+e.location+"\" data-city=\""+e.city+"\"><div class =\"search-string\">"+e.location+"</div></div>"))})}else"error"==s.status&&($(".loc-error").show(),$(".loc-error").html(s.message),document.getElementById("save-addr").disabled=!0,$("#confirmed-save-addr").prop("disabled",!0),fn.msite.hideloader())})},saveAddress:function(){var e=Math.round;$(".save-btn.save-addr").on("click",function(){$(".save-btn.save-addr").prop("disabled",!0);var a=$(this);if(marker1=[],!a.hasClass("clicked")){a.addClass("clicked");var t=$(".customer-info"),s=t.data("addrid"),o=t.find(".name").val(),r=t.find(".email").val(),d=t.find(".mobile").val(),n=t.find(".line1").val(),l=t.find(".line2").val(),c=t.find(".city").val(),p=t.find(".landmark").val(),m=t.find(".line1").attr("data-lat"),u=t.find(".line1").attr("data-lng"),h=t.find(".line1").attr("data-state"),v=t.find(".line1").attr("data-pincode"),y={line1:l,line2:n,city:c,lat:+m,lng:+u,address_id:s,contact:d,landmark:p,state:h,pincode:v},_=JSON.parse(localStorage.getItem("profile_complete"));if(fn.localStorageCheck(_)&&("false"!=_.status&&_.status?Object.assign(y,{name:_.name,email:_.email}):(Object.assign(y,{name:o,email:r}),clevertap.profile.push({Site:{Name:"".concat(t.find(".name").val()),Email:"".concat(t.find(".email").val())}}))),li_fn.checkout.validateAddress()){var g=function(e,t,s,i){var o=Math.sqrt,r=Math.cos,d=Math.sin,n=w(s-e),l=w(i-t),p=d(n/2)*d(n/2)+r(w(e))*r(w(s))*d(l/2)*d(l/2),a=2*Math.atan2(o(p),o(1-p));return 1e3*(6371*a)},w=function(e){return e*(Math.PI/180)};$(".save-btn.save-addr").prop("disabled",!1),$(".confirm-location-wrap").addClass("show"),$(".address-popup .address-wrap .wrapper").hide();for(var f=new google.maps.Geocoder,b=n+", "+l,C=0;C<marker1.length;C++)marker1[C]&&marker1[C].setMap&&marker1[C].setMap(null);f.geocode({address:b},function(a,t){if("OK"===t){resultArray=[];var s={url:"https://d2407na1z3fc0t.cloudfront.net/Banner/otherlocation.png",scaledSize:new google.maps.Size(30,30),anchor:new google.maps.Point(15,15)};if($.map(a,function(a){var t={lat:y.lat,lng:y.lng},s={lat:a.geometry.location.lat(),lng:a.geometry.location.lng()},i=g(t.lat,t.lng,s.lat,s.lng);resultArray.push({distance:i,lat:s.lat,lng:s.lng,faddress:a.formatted_address}),1==resultArray.length&&(mapReset({lat:resultArray[0].lat,lng:resultArray[0].lng},resultArray[0].faddress),100>=e(resultArray[0].distance)?map.setZoom(18):500>=e(resultArray[0].distance)?map.setZoom(16):1e3>=e(resultArray[0].distance)?map.setZoom(15):2e3>=e(resultArray[0].distance)?map.setZoom(14):3e3>=e(resultArray[0].distance)?map.setZoom(13.5):4e3>=e(resultArray[0].distance)?map.setZoom(13):6e3>=e(resultArray[0].distance)?map.setZoom(12.5):8e3>=e(resultArray[0].distance)?map.setZoom(12):map.setZoom(11))}),resultArray.sort(function(e,a){return e.distance-a.distance}),0<resultArray.length){if(20>=e(resultArray[0].distance)){var i={lat:resultArray[0].lat,lng:resultArray[0].lng};marker1[0]=new google.maps.Marker({position:i,icon:s,title:"Hello World!"}),marker1[0].setMap(map),$(".two-loc-popup").hide()}else{var i={lat:resultArray[0].lat,lng:resultArray[0].lng};marker1[0]=new google.maps.Marker({position:i,icon:s,title:"Hello World!"}),marker1[0].setMap(map);var o={lat:y.lat,lng:y.lng};marker1[1]=new google.maps.Marker({position:o,icon:s,title:"Hello World!"}),marker1[1].setMap(map),$(".two-loc-popup").show()}google.maps.event.addListener(marker1[0],"click",function(){var e={lat:resultArray[0].lat,lng:resultArray[0].lng};mapReset(e,resultArray[0].faddress)}),google.maps.event.addListener(marker1[1],"click",function(){var e={lat:y.lat,lng:y.lng};mapReset(e,y.line2)})}}else alert("Geocode was not successful for the following reason: "+t)}),$(".map-move-notify").show(),li_fn.checkout.confirmSaveAddr(),a.removeClass("clicked")}else a.removeClass("clicked"),$(".confirm-location-wrap").removeClass("show"),$(".address-popup .address-wrap .wrapper").show(),$(".save-btn.save-addr").prop("disabled",!1)}})},confirmSaveAddr:function(){$("#confirmed-save-addr").on("click",function(a){a.stopImmediatePropagation();var e=$(".customer-info"),t=e.data("addrid"),s=e.find(".name").val(),i=e.find(".email").val(),o=e.find(".mobile").val(),r=e.find(".line1").val(),d=e.find(".line2").val(),n=e.find(".city").val(),l=e.find(".landmark").val(),c=e.find(".line1").attr("data-lat"),p=e.find(".line1").attr("data-lng"),m=e.find(".line1").attr("data-state"),u=e.find(".line1").attr("data-pincode"),h={line1:d,line2:r,city:n,lat:c,lng:p,address_id:t,contact:o,landmark:l,state:m,pincode:u},v=JSON.parse(localStorage.getItem("profile_complete"));fn.localStorageCheck(v)&&("false"!=v.status&&v.status?Object.assign(h,{name:v.name,email:v.email}):Object.assign(h,{name:s,email:i})),fn.msite.showloader(),fn.ajaxForm(h,"POST","/customer/li-save-address").done(function(e){var a=JSON.parse(e);if("success"==a.statusMessage){var t=$(".all-addresses").find(".list").length;localStorage.setItem("no_address",!1),localStorage.setItem("addr_value",!1);var s=JSON.parse(localStorage.getItem("prod_data"));if(fn.localStorageCheck(s)){var i={Source:"Checkout_ConfirmAddress","Cart Value":+localStorage.getItem("cart_subtotal"),"City Name":localStorage.getItem("city"),"Hub ID":+localStorage.getItem("hub"),"Product ID":s.pr_ids,"Product Name":s.pr_name,Quantity:s.pr_qty,"Saved Amount":+localStorage.getItem("saveamount")};clevertap.event.push("Checkout_ConfirmAddress",i),ga("send",{hitType:"event",eventCategory:"Checkout_ConfirmAddress",eventAction:"Checkout_ConfirmAddress",eventLabel:JSON.stringify(i)}),"true"==localStorage.getItem("editbysave")?li_fn.checkout.eventAddressPage("Save Address",t,"Checkout_EditAddress"):li_fn.checkout.eventAddressPage("Save Address",t+1,"Checkout_SaveAddress")}"profile"==$(".pagehead").val()?window.location.href="/profile":(localStorage.setItem("default_addr_id",a.data.address.address_id),localStorage.setItem("default_pincode",a.data.address.pincode),localStorage.setItem("default_lat",a.data.address.lat),localStorage.setItem("default_lng",a.data.address.lng),li_fn.city_name=a.data.address.city,fn.msite.changeAddr(a.data.address.lat,a.data.address.lng).done(function(e){var t=JSON.parse(e);"LOCATION_CHANGED"==t.status?li_fn.checkout.checkoutAlert("address",t.message):"ERROR"==a.status?li_fn.checkout.checkoutAlert("no_items",t.message):"SERVICABLE"==t.status&&t.data&&(fn.msite.updateHub(t.data),localStorage.setItem("selected","true"),window.location.href="/customer/cart-summary")}))}else alert(a.data.errorMessage);elem.removeClass("clicked")}).always(function(){fn.msite.hideloader()})})},editAddress:function(){$(".edit-btn").on("click",function(){var e=$(this).attr("data-addrid");fn.ajaxForm({address_id:e},"POST","/customer/li-getaddressbyid-address").done(function(e){var a=JSON.parse(e);if("success"==a.statusMessage){var t=$(".all-addresses").find(".list").length,s=a.data.address;$(".page-header .back-button").addClass("close-pop-address"),$(".address-wrapper").removeClass("show"),$(".address-popup").addClass("show"),$(".page-header img").attr("src","/images/dd.png"),$(".page-header .title").html("Add Address"),$(".page-header img").css("width","15px"),$(".remove-img").addClass("show");var i=$(".customer-info");i.attr("data-addrid",s.address_id),i.find(".line1").val(s.line2),i.find(".line2").val(s.line1),i.find(".landmark").val(s.landmark),i.find(".mobile").val(s.contact),i.find(".city").val(s.city);var o={lat:s.lat,lng:s.lng},r=new google.maps.LatLng(o.lat,o.lng);map.panTo(r),localStorage.setItem("editbysave","true");var t=$(".all-addresses").find(".list").length;li_fn.checkout.eventAddressPage("Edit Address",t,"Checkout_EditAddress")}})})},selectAddress:function(){$(".list .address-container").on("click",function(a){a.stopImmediatePropagation(),fn.msite.showloader();var e=$(this);$(".all-addresses .list").removeClass("selected"),localStorage.setItem("selected","false"),$(this).parent().addClass("selected"),$(".edit-btn").attr("disabled",!0),$(".delete-btn").attr("disabled",!0),$(this).parent().find(".edit-btn").removeAttr("disabled"),$(this).parent().find(".delete-btn").removeAttr("disabled"),localStorage.setItem("default_addr_id",e.data("addrid")),localStorage.setItem("default_pincode",e.data("pincode")),localStorage.setItem("default_lat",e.data("lat")),localStorage.setItem("default_lng",e.data("lng")),li_fn.city_name=e.data("city");var t=$(".all-addresses").find(".list").length;fn.msite.changeAddr(e.data("lat"),e.data("lng")).done(function(e){var a=JSON.parse(e);"LOCATION_CHANGED"==a.status?li_fn.checkout.checkoutAlert("address",a.message):"ERROR"==a.status?li_fn.checkout.checkoutAlert("no_items",a.message):"SERVICABLE"==a.status&&a.data&&(fn.msite.updateHub(a.data),localStorage.setItem("selected","true"),li_fn.checkout.eventAddressPage("Choose Address",t,"Checkout_chooseAddress"))}).always(function(){fn.msite.hideloader()})})},confirmAddress:function(){$(".addr-confirm").on("click",function(){var e=localStorage.getItem("default_addr_id");localStorage.setItem("back_page","address");var a=$(".all-addresses").find(".list.selected").length;if(e&&""!=parseInt(e)&&0<a){var t=JSON.parse(localStorage.getItem("products"));if(fn.localStorageCheck(t)){var s=!t.exotic?t.normal:t.normal.concat(t.exotic),i=[],o=[],r=[];$.map(s,function(e){o.push(e.product_name),i.push(e.product_id),r.push(+e.quantity)});var d={Source:"Checkout_Proceedaddress","Cart Value":+localStorage.getItem("cart_withoutshipping"),"City Name":fn.cityName,"Hub ID":+fn.hubId,"Product Name":o,"Saved Value":+localStorage.getItem("saveamount")," Quantity":r,"Product ID":i};clevertap.event.push("Checkout ProceedAddress",{Source:"Checkout_Proceedaddress","Cart Value":+localStorage.getItem("cart_withoutshipping"),"City Name":fn.cityName,"Hub ID":+fn.hubId,"Product Name":JSON.stringify(o),"Saved Value":+localStorage.getItem("saveamount")," Quantity":JSON.stringify(r),"Product ID":JSON.stringify(i)}),ga("send",{hitType:"event",eventCategory:"Checkout_Proceedaddress",eventAction:"Checkout_SelectProceed",eventLabel:JSON.stringify(d)})}setTimeout(function(){window.location.href="/customer/cart-summary"},300)}else li_fn.checkout.checkoutAlert("select-addr","Please add address or select any of addresses")})},checkoutAlert:function(e,a){var t=$(".checkout-oos-alert");$(".checkout-oos-alert").show();"address"===e?(t.find(".header").html("Alert[Change in Delivery address]"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.change-addr").addClass("show"),t.find(".ctas button.review-cart").addClass("show"),t.find(".content .message").html(a||"We have detected a change in your Delivery address.The Above will affect the Product availability, pricing, offers and more..")):"no_items"===e?(t.find(".header").html("Alert [Cart Empty]"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.continue-shopping").addClass("show"),t.find(".content .message").html(a),$(".add_message").hide()):"select-addr"===e?(t.find(".header").html("Alert"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.dismiss").addClass("show"),t.find(".content .message").html(a||"Please select any of the addresses")):"offer_modified"===e?(t.find(".header").html("Alert [Change Product availability]"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.viewcart").addClass("show"),t.find(".content .message").html(a)):"error"===e?(t.find(".header").html("Alert [SomeThing went wrong]"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.dismiss").addClass("show"),t.find(".content .message").html(a)):"coupon"===e?(t.find(".header").html("Alert"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.ok").addClass("show"),t.find(".ctas button.cancelbtn").addClass("show"),t.find(".content .message").html("Coupon applied will be removed")):"free_delivery"===e?(t.find(".header").html("Alert"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.remove-cpn").addClass("show"),t.find(".ctas button.apply-cpn").addClass("show"),t.find(".content .message").html(a)):"below_limit"===e?(t.find(".header").html("Alert"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.delivery-waived").addClass("show"),t.find(".content .message").html(a)):"paytm_fail"===e?(t.find(".header").html("Alert"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.load-money-failed").addClass("show"),t.find(".content .message").html(a||"Load money failed. Please retry")):"api_fail"===e?(t.find(".header").html("Alert"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.reload-page").addClass("show"),t.find(".content .message").html(a||"Something went wrong. Please retry")):"upi"===e?(t.find(".header").html("Are you sure to go back?"),t.find(".ctas button").removeClass("show"),t.find(".ctas button.upi-stay").addClass("show"),t.find(".ctas button.upi-leave").addClass("show"),t.find(".content .message").html(a)):void 0;fn.msite.alertCtas(),fn.msite.reviewCart()},checkoutMsg:function(e,a){$(".checkout-msg").removeClass("hide"),$(".checkout-msg").html(a),$(".checkout-msg").addClass("show"),$(".checkout-msg").removeClass("error"),$(".checkout-msg").removeClass("success"),$(".checkout-msg").removeClass("warning"),setTimeout(function(){$(".checkout-msg").removeClass("show")},3e3);"success"===e?$(".checkout-msg").addClass("success"):"error"===e?$(".checkout-msg").addClass("error"):"warning"===e?$(".checkout-msg").addClass("warning"):"empty"===e?($("#mainWrapper .empty-cart").show(),$(".continue-shop").on("click",function(a){a.stopImmediatePropagation(),window.location.href="/",$("#mainWrapper .empty-cart").hide()})):void 0},validateAddress:function(){var e=$(".customer-info"),a=e.find(".name").val(),t=e.find(".email").val(),s=e.find(".mobile").val(),i=e.find(".line1").val(),o=e.find(".line2").val(),r=e.find(".city").val(),d=e.find(".city").attr("data-id"),n=e.find("#locationpop").attr("data-lat"),l=e.find("#locationpop").attr("data-lng"),c=!0,p={addr_1:{val:i},addr_2:{val:o},city:{val:r},mobile:{val:s},email:{val:t},name:{val:a}},m="none"!=$(".username").css("display");return""==i||""==o||""==r&&""==a||""==t||""==s?(li_fn.checkout.checkoutMsg("error","Required field"),c=!1,$.map(p,function(a,t){""==a.val?e.find("[data-elem=\""+t+"\"]").css({borderColor:"red"}):e.find("[data-elem=\""+t+"\"]").css({borderColor:"grey"})}),c):(""==n||""==l?li_fn.checkout.checkoutMsg("error","Latitude and Longitude not found !"):$.map(p,function(a,t){"name"===t?!/^([a-zA-Z ]{3,30})$/.test(a.val)&&m&&(li_fn.checkout.checkoutMsg("error","Name can contain only Alphabets"),c=!1):"email"===t?/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(a.val)?e.find("[data-elem=\""+t+"\"]").parent().find(".val_elem").remove():(li_fn.checkout.checkoutMsg("error","Email can be of type <i>person@domain.com</i>"),c=!1):"mobile"===t?5>=a.val.charAt(0)?(li_fn.checkout.checkoutMsg("error","Mobile number should  start with 6/7/8/9"),c=!1):10>a.val.length?(li_fn.checkout.checkoutMsg("error","Mobile number should be of 10 digits"),c=!1):!/^\d{10}$/.test(a.val)&&(li_fn.checkout.checkoutMsg("error","Mobile Number can be of digits 0-9"),c=!1):void 0}),c)},mapShipmentDetailsForLS:function(e){var a=[],t=[],s=[],i=[],o=[],r=[],d=[],n=[],l=[],c={"Cart Value":$(".proceed-payment .amount").attr("data-total"),"City Name":fn.cityName,"Saved Value":+localStorage.getItem("Saved_amount"),"Hub ID":+fn.hubId,"Reason for Slot":"","Split Slot":1<e.length?"True":"False","No of Split":e.length,"Category ID":fn.getCategoryId()},p=0,a=[],t=[],s=[],m=[];localStorage.setItem("product_data",null),$.map(e,function(u){if("EXPRESS"==e[0].slots[0].type&&!0==e[0].slots[0].selected?Object.assign(c,{"Default Slot":"Express"}):Object.assign(c,{"Default Slot":"Scheduled"}),m=[].concat(_toConsumableArray(m),_toConsumableArray(u.products)),$.map(u.products,function(e){i.push(e.product_name),o.push(e.type),r.push(e.quantity),d.push(e.live_stock_avail),n.push(e.dispatched_quantity_avail),l.push(e.rm_buffer_avail),s.push(e.product_id),a.push(e.product_name),t.push(e.quantity)}),"EXPRESS"==u.slots[0].type)Object.assign(c,{"Express Item Count":u.products.length,"Express Delivery Items":i.toString(),"Express Item types":o.toString(),"Express Item Quantity":r.toString(),"Express Item Live Inventory":d.toString(),"Express Item DP":n.toString(),"Express Item RM":l.toString()});else{++p;var h={};h["Slot "+p+" Item Count"]=u.products.length,h["Scheduled"+p+" delivery Items"]=i.toString(),h["Scheduled"+p+" Item types"]=o.toString(),h["Scheduled"+p+" Item Quantity"]=r.toString(),h["Scheduled"+p+" Live Inventory"]=r.toString(),h["Scheduled"+p+" Item DP"]=n.toString(),h["Scheduled"+p+" Item RM"]=l.toString(),Object.assign(c,h)}}),fn.setLsProducts(m);var u={pr_name:a,pr_id:s,pr_qty:t};localStorage.setItem("product_data",JSON.stringify(u));Object.assign(c,{Source:"Checkout_Slot"}),clevertap.event.push("Slot Selection Load",c);ga("send",{hitType:"event",eventCategory:"Checkout_Slot",eventAction:"Checkout_defaultslot",eventLabel:JSON.stringify(c)});localStorage.setItem("product_data",JSON.stringify(u))},getShipmentSummary:function(){return new Promise(function(e){fn.msite.showloader(),fn.ajaxForm({},"GET","/customer/li-shipment-slot").done(function(a){var t=JSON.parse(a),s="";if(200==t.statusCode){var i=t.data.shipment_summary,o=t.data.order_charges,r=t.data.messages,d=t.data.dynamic_delivery_message;if($.map(o,function(e){"subtotal"==e.key.toLowerCase()&&($(".amount").attr("data-total",e.value),$(".slot-summary-wrapper .amount span").html("Total: &#8377; "+e.value)),("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&$(".delivery-fee").html("Delivery fee: \u20B9 "+e.value)}),$(".slot-payment-charges").html(""),$(".bill-details").show(),$(".bd-contents ul").html(""),$.map(o,function(e){("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&($(".delivery-fee").html("Delivery fee: \u20B9 "+e.value),localStorage.setItem("loyalty_delivery_charge",e.value.toString()));var a="",t=void 0===e.message?"":"<span class=\"message\">"+e.message+"</span>";"discount"!=e.key.toLowerCase()&&"wallet"!=e.key.toLowerCase()&&"liciouswallet"!=e.key.toLowerCase()&&("total"===e.key.toLowerCase()?(localStorage.setItem("loyalty_cart_value",e.value.toString()),$(".slot-summary-wrapper .amount span").html("Total: &#8377; "+e.value),a="<li ><div class=\"seperator\"></div></li><li><div class=\"slot-key-total\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"slot-value-total\"> \u20B9 "+ +e.value+"</div></li>"):(t=("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&0>=e.value?"<span class=\"message\" style=\"color:#417505\">"+e.message+"</span>":t,a="<li><div class=\"slot-key\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"slot-value\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</div></li>"),$(".bd-contents ul").append(a))}),!li_fn.checkout.validateLoyaltyEligibilitySlotPage(t.data.loyalty_item))document.getElementsByClassName("home-page-loyalty-member-banner")[0].style.display="none";else if(t.data.hasOwnProperty("loyalty_item")&&null!==t.data.loyalty_item){fn.setLSLoyaltyData(t.data.loyalty_item);var n=0>=t.data.loyalty_item[0].price-t.data.loyalty_item[0].discounted_price?"":"\u20B9 "+t.data.loyalty_item[0].price;document.getElementsByClassName("home-page-loyalty-member-banner")[0].style.display="flex",$(".home-page-loyalty-member-banner").attr("plan_id",t.data.loyalty_item[0].subprogram_id),$(".home-page-loyalty-member-expiry-info").html(t.data.loyalty_item[0].subprogram_name),$(".home-page-loyalty-actprice").html(n),$(".home-page-loyalty-discprice").html("\u20B9 "+t.data.loyalty_item[0].discounted_price)}0<t.data.shipment_alert_message.length&&(s=t.data.shipment_alert_message[0].message),li_fn.checkout.mapShipmentDetailsForLS(i),li_fn.checkout.renderShipments(i,r,s,d,o),li_fn.checkout.deleteSummaryItem(),li_fn.checkout.lockSlot()}else 202==t.statusCode&&"empty_cart"==t.data.errorMessage?($(".whole-container").html(""),li_fn.checkout.checkoutAlert("no_items",t.data.message)):li_fn.checkout.checkoutAlert("offer_modified",t.data.message);e(t)}).always(function(){fn.msite.hideloader()})})},productDetailsForEEcommerce:function(e){if(e){var a=e.products,t=e.exotic,s=[],i=Array.isArray(a)?a.reduce(function(e,a,t){var s=a.product_id,i=a.product_name,o=a.category_name,r=a.base_price,d=a.quantity,t=t;return e.push({item_id:s,item_name:i,item_category:o,price:r,quantity:d,currency:"INR",index:t}),e},[]):[],o=Array.isArray(t)?t.reduce(function(e,a,t){var s=a.product_id,i=a.product_name,o=a.category_name,r=a.base_price,d=a.quantity,t=t;return e.push({item_id:s,item_name:i,item_category:o,price:r,quantity:d,currency:"INR",index:t}),e},[]):[];return s=i.concat(o),s}return[]},pushEECheckoutInProgress:function(e){var a={};try{var t=li_fn.checkout.productDetailsForEEcommerce(e);if(a={checkout_step:"quick_checkout"===fn.msite.getCheckoutFlowType()?"2.0":"1.0",item_list:t},fn.msite.branchIO.addEvent("checkout_progress",a),window.dataLayer){var s=window.dataLayer;s.push({event:"checkout_progress",ecommerce:{checkout_progress:{actionField:{step:2,option:"slot"},products:t}}})}}catch(t){fn.msite.branchIO.branchLogErr(t,a,"checkout_progress")}},lockShipmentData:function(e){var a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:void 0,t=a?a:fn.msite.getCheckoutFlowType();$(".proceed-payment").on("click",function(a){a.stopImmediatePropagation(),fn.msite.showloader(),fn.ajaxForm({},"GET","/customer/li-lock-shipment").done(function(a){var s=JSON.parse(a);if(200==s.statusCode){var i="",o=[],r=[],d=[];localStorage.setItem("li_order_charges",JSON.stringify(s.data.order_charges)),localStorage.setItem("delivery-message",s.data.messages.message),localStorage.setItem("pay_later_data",""),localStorage.setItem("coupon_type",""),localStorage.setItem("coupon",""),localStorage.setItem("web_ordercharges",JSON.stringify(s.data.order_charges)),$.map(s.data.order_charges,function(e){"total"==e.key.toLowerCase()&&(i=e.value,localStorage.setItem("final_amt",parseInt(e.value)),localStorage.setItem("li_pay_amt",parseInt(e.value)))});var n={Checkout_Flow:t,Source:"Checkout_Slot","Cart Value":i,"City Name":fn.cityName,"Hub ID":+fn.hubId,"Saved Value":localStorage.getItem("Saved_amount"),"Is Split order":!!(1<e.length),"No of Split":e.length,Defaultslot:"EXPRESS"==e[0].slots[0].type?"Express":"Scheduled","Category ID":fn.getCategoryId()};$.map(e,function(e){$.map(e.products,function(e){o.push(e.product_name),r.push(e.product_id),d.push(e.quantity)})}),Object.assign(n,{"Product ID":r.toString(),"Product Name":o.toString(),Quantity:d.toString()}),ga("send",{hitType:"event",eventCategory:"Checkout_Slot",eventAction:"Checkout_ProceedPayment",eventLabel:JSON.stringify(n)}),clevertap.event.push("Payment Initiated",n);var l=JSON.parse(localStorage.getItem("products"));if(fn.localStorageCheck(l)){var c={products:l.normal,exotic:l.exotic};li_fn.checkout.pushEECheckoutInProgress(c)}setTimeout(function(){window.location.href="/customer/payments"},1500)}else localStorage.setItem("li_order_charges",""),window.location.href.includes("past-orders")||window.location.href.includes("favourite-items")?(fn.msite.add_alert("hide",s.data.message),setTimeout(function(){window.location.reload()},3e3)):li_fn.checkout.checkoutAlert("offer_modified",s.data.message)}).always(function(){fn.msite.hideloader()})})},lockSlot:function(){var a,t,s,i,o;$(document).on("click",".slot-list .slots",function(r){r.stopImmediatePropagation(),a=$(this).attr("data-date"),t=$(this).attr("data-time"),s=$(this).attr("data-shipid"),i=new Date,o=i.getHours();$(".slots").removeClass("active");$(this).addClass("active")}),$(document).on("click",".slot-selected",function(o){o.stopImmediatePropagation(),fn.msite.showloader(),fn.ajaxForm({date:a,slot:t,shipment_id:s},"POST","/customer/li-lock-slot").done(function(e){var a=JSON.parse(e);if(200==a.statusCode){$(".slot-main-container").removeClass("show");var o={"Split Slot":!!(1<a.data.shipment_summary.length),"No of Split":a.data.shipment_summary.length,"Scheduled Date":t+" - "+i,"Shipment ID":+s},r=[],d=[];$.map(a.data.shipment_summary,function(e){"EXPRESS"==e.slots[0].type&&!0==e.slots[0].selected?Object.assign(o,{"Default Slot":"Express"}):Object.assign(o,{"Default Slot":"Scheduled"}),"EXPRESS"==e.slots[0].type?$.map(e.products,function(e){r.push(e.product_name)}):$.map(e.products,function(e){d.push(e.product_name)})}),Object.assign(o,{"Express delivery Items":r.toString(),"Scheduled Delivery Items":d.toString()});var n=o;Object.assign(n,{Source:"checkout_Slot"}),clevertap.event.push("Changed Slot",n),ga("send",{hitType:"event",eventCategory:"checkout_Slot",eventAction:"Checkout_changeSlot",eventLabel:JSON.stringify(o)}),li_fn.checkout.renderShipments(a.data.shipment_summary,a.data.messages,null,a.data.dynamic_delivery_message,a.data.order_charges)}else $(".slot-main-container").removeClass("show"),500==a.statusCode&&alert(a.data.message),202==a.statusCode&&li_fn.checkout.checkoutAlert("offer_modified",a.data.message)}).always(function(){fn.bodyScroll(),fn.msite.hideloader()})})},lockStocks:function(){return fn.ajaxForm({},"GET","/customer/li-lock-shipment")},renderShipments:function(a,e,t,s,i){var s=s;$(".whole-container").html("");var o=!0,r=[],d=[];$.map(i,function(e){"subtotal"==e.key.toLowerCase()&&($(".amount").attr("data-total",e.value),$(".slot-summary-wrapper .amount span").html("Total: &#8377; "+e.value)),("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&$(".delivery-fee").html("Delivery fee: \u20B9 "+e.value)}),$(".slot-payment-charges").html(""),$(".bill-details").show(),$(".bd-contents ul").html(""),$.map(i,function(e){("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&($(".delivery-fee").html("Delivery fee: \u20B9 "+e.value),localStorage.setItem("loyalty_delivery_charge",e.value.toString()));var a="",t=e.message===void 0?"":"<span class=\"message\">"+e.message+"</span>";"discount"!=e.key.toLowerCase()&&"wallet"!=e.key.toLowerCase()&&"liciouswallet"!=e.key.toLowerCase()&&("total"===e.key.toLowerCase()?(localStorage.setItem("loyalty_cart_value",e.value.toString()),$(".slot-summary-wrapper .amount span").html("Total: &#8377; "+e.value),a="<li ><div class=\"seperator\"></div></li><li><div class=\"slot-key-total\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"slot-value-total\"> \u20B9 "+ +e.value+"</div></li>"):(t=("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&0>=e.value?"<span class=\"message\" style=\"color:#417505\">"+e.message+"</span>":t,a="<li><div class=\"slot-key\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"slot-value\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</div></li>"),$(".bd-contents ul").append(a))});$(".whole-container").append("<div class=\"shipment-slots express-delivery\"></div><div class=\"shipment-slots scheduled-delivery\"></div>"),$.map(a,function(s,i){r.push(s.id);var n="",l=new Date(s.delivery_timestamp);s.selected==null&&(o=!1);var c=!1,p="",m="",a="";$.map(s.slots,function(e){var t=new Date(e.timestamp);!0==e.selected&&$.map(e.slots,function(e){!0==e.selected&&(p=e.time,c=!0,m=t)})}),a=!0==c?p:"Select delivery slot";var u=!1==c?"border-red":"",h="";0<i&&(h="<div class=\"split-msg\">"+e[0].message+"</div>"),h+="<div class=\"time-header\">"+s.messages.message+"</div><div class = \"slot-selection "+(u+" ship_"+s.id)+"\" data-pr_length=\""+s.products.length+"\" data-shipid=\""+s.id+"\" data-index=\""+(i+1)+"\"> <span class=\"time-slot ship_"+s.id+"\" data-time=\""+a+"\">"+a+"</span><i class=\"arrow down\"></i > </div><div class=\"shipment-alert\"></div><ul class = \"item-list ship-"+i+"\" ></ul>",fn.msite.fetchAddressApi().then(function(e){fn.msite.setAddressFields(e)}),$(".addr_change_container").show(),$.map(s.products,function(e){d.push(e.quantity);var a="",t=e.shipment_quantity.replace(" of ","/"),i=0<e.discount?"<span class=\"discounted-price\">&#8377; "+e.base_price+"</span><span class=\"base-price\">&#8377; "+e.actual_price+"</span></div>":"<span class=\"discounted-price\">&#8377; "+e.actual_price+"</span></div>";a=e.pieces?e.pieces:e.weight,n+="<li class=\"item\" data-shipid=\""+s.id+"\"><div class=\"item-image\"><img class=\"picture\" src=\""+e.image+"\"></div><div class=\"product-desc\"><div class=\"pr-name\">"+e.product_name+"</div><div class=\"pr-details\"><div class=\"weight\">"+a+"</div><div class=\"amount\">"+i+"<div class=\"quantity\"><div class=\"split-message\">"+e.shipment_info_message+"</div><span class=\"net-quantity\">"+(!1==e.is_split?"":"<img src=\"/images/information.png\" class=\"information-image\" data-ship_id=\""+s.id+"\" data-pr_name=\""+e.product_name+"\" data-cat_name=\""+e.category_name+"\">")+"Qty: "+(!0==e.is_split?"<span style=\"color: #e41d36;\">"+t+"</span>":e.quantity)+"</span><span class=\"delete-item\" data-shipid=\""+s.id+"\" data-pr_id=\""+e.product_id+"\" data-pr_name=\""+e.product_name+"\" data-cat_name=\""+e.category_name+"\" data-is_split=\""+e.is_split+"\" data-is_combo_child=\""+e.is_combo_child+"\" data-title=\""+e.combo_pop_up_messages.title+"\" data-description=\""+e.combo_pop_up_messages.description+"\" data-alert_message=\""+e.combo_pop_up_messages.alert_message+"\">X</span></div></div></div></li>"}),"EXPRESS"==s.slots[0].type?($(".shipment-slots.express-delivery").addClass("show"),$(".shipment-slots.express-delivery").append(h),$(".shipment-slots.express-delivery").find(".shipment-alert").html(t),$(".shipment-slots.express-delivery").find(".item-list.ship-"+i).append(n)):($(".shipment-slots.scheduled-delivery").addClass("show"),$(".shipment-slots.scheduled-delivery").append(h),$(".shipment-slots.scheduled-delivery").find(".item-list.ship-"+i).append(n))}),localStorage.setItem("shipping_id",JSON.stringify(r)),localStorage.setItem("qty_array",JSON.stringify(d)),!0==o?($(".proceed-payment").removeAttr("disabled"),$(".proceed-on-payment .section-two").html("Select payment method")):$(".proceed-payment").attr("disabled",!0),$(".slot-close").on("click",function(a){a.stopImmediatePropagation(),fn.bodyScroll(),$(".slot-main-container").removeClass("show"),$(".date-selection .dates").removeClass("date-selected"),$(".slot-lock .slot-list").css("display","none"),clevertap.event.push("Closed Slot Selection",{Source:"Checkout_Slot"}),ga("send",{hitType:"event",eventCategory:"checkout_Slot",eventAction:"Checkout_Slot_Closedslotclick",eventLabel:""})}),$(".slot-selection").on("click",function(t){t.stopImmediatePropagation();var e=$(this).attr("data-index"),i=$(this).attr("data-shipid");$(".slot-main-container").addClass("show"),fn.noScroll();var o=a.filter(function(e){return e.id==i});$(".apology-msg").hide(),!o[0].slot_message||($(".apology-msg").show(),$(".apology-msg").html(o[0].slot_message)),li_fn.checkout.renderSlots(o[0].slots,i,a.length,e,s)});var n="",l="",c=1,p="",m="";$.map(e,function(e){"warning"==e.style&&"eggs"==e.condition?(n=e.message,m=e.condition):c<=e.priority&&(c=e.priority,p=e.message,l=e.style)}),"eggs"==m&&li_fn.checkout.checkoutAlert("offer_modified",n),0<s.length&&"warning"==s[0].style?$(".whole-container").prepend("<div class=\"multi-order\"><div>"+"<p>".concat(s[0].message," </p></div>\n          <img src=\"/images/information@3x.png\" class=\"info\"/>\n          </div>")):0<s.length&&"success"==s[0].style&&($(".freeDeliveryOrders").html(s[0].message),$(".freeDeliveryOrders").show()),li_fn.checkout.display_info(s),li_fn.checkout.deleteSummaryItem(),li_fn.checkout.lockSlot(),li_fn.checkout.lockShipmentData(a)},display_info:function(e){!e||0==e.length||($(".info-heading").html("<div>"+e[0].information_header+"</div>"),$(".slot-info-text").html("<div>"+e[0].information+"</div>")),$(".info").on("click",function(a){a.stopImmediatePropagation(),$(".slot-info").addClass("show"),fn.bodyScroll()}),$(".slot-info-close").on("click",function(a){a.stopImmediatePropagation(),$(".slot-info").removeClass("show"),fn.bodyScroll()})},renderSlots:function(e,t,a,s,i){$(".slots-wrapper .date-selection").html(""),$(".slot-lock").find("ul").remove(),$.map(e,function(e,o){var r="",d=!0==e.selected?"date-selected":"",n=new Date(e.timestamp);r=n.getDate()==new Date().getDate()?"Today "+li_fn.checkout.formatDate(n):n.getDate()==new Date().getDate()+1?"Tomorrow "+li_fn.checkout.formatDate(n):li_fn.checkout.formatDate(n),$(".slot-header .heading").html("Select Slot for Shipment  "+s),$(".slots-wrapper .date-selection").append("<li class=\"dates "+d+"\" data-slot=\""+o+"\" data-shipid=\""+t+"\"><span>"+r+"</span></li>"),$(".slot-lock").append("<ul class=\"slot-list slot_"+o+"\" data-slot=\""+o+"\"></ul>"),$.map(e.slots,function(a){var s=!0==a.selected?"active":"",r="<li class=\"slot-list-data\"><button class=\"slots "+s+" "+(0==a.status?"opacity":"")+"\" data-date=\""+e.date+"\" data-time=\""+a.time+"\" data-shipid=\""+t+"\" "+(0==a.status?"disabled=\"disabled\"":"")+">"+a.time+"</button>";i.length&&(2==a.show_delivery_type&&1==a.status?r+="<span class=\"freeDelivery\"> ".concat(a.message,"</span>"):(3==a.show_delivery_type||4==a.show_delivery_type)&&1==a.status?r+="<span class=\"paidDelivery\"> ".concat(a.message,"</span>"):r+="<span class=\"paidDelivery\">&nbsp;</span>"),r+="</li>",$(".slot-lock .slot-list.slot_"+o).append(r)})}),$(".slot-lock .slot-list.slot_".concat(slot_id)).css("display","block"),$(".slots-wrapper .date-selection .dates").on("click",function(a){a.stopImmediatePropagation(),$(".slots-wrapper .date-selection .dates").removeClass("date-selected"),$(".slot-lock .slot-list").css("display","none");var e=$(this).attr("data-slot");slot_id=e,$(this).addClass("date-selected"),$(".slot-lock .slot-list.slot_"+e).css("display","block")})},variableWeightAdjustment:function(e,a){elem=$(".variation_explainer"),elem.html(""),elem.hide();var t=e.extraGrammage.eg_status,s=e.edit_order.status,i=e.content,o="";if(1==e.status){o+="<div class='variation-header'>\n        <img src=\"/images/icon_circular_alert.png\">\n        <div class=\"vh-heading\">".concat(e.title,"</div>\n        <div class=\"vh-amount ").concat(0<e.header_total_amount?"outstanding-amt":"","\">\u20B9 ").concat(e.header_total_amount,"</div>\n        </div>"),1<i.length?(o+="<div class='variation-content'><ul>",$.map(i,function(e){o+="<li class=\"list-item\">".concat(e,"</li>")}),o+="</ul></div>"):o+="<div class='variation-content'>\n          ".concat(e.content,"\n          </div>\n          "),o+="<div class=\"varition-list-items\">";var r=e.line_items;$.map(r,function(e,a){console.log(e,a),o+="<div class=\"varition-list-item\"><div class=\"desc ".concat((2==t||s)&&("line_total"==e.key||"ls_line_total"==e.key)?"credit-text":"","\">").concat(e.message,"</div>\n          <div class=\"desc-amt\">\u20B9 ").concat(e.amount,"</div></div>")}),o+="</div>",(2==t||3==t||s&&"cod"!=a.payment_type.toLowerCase())&&(o+="<a href=\"/profile\"><div class=\"view-wallet\">VIEW WALLET</div></a>"),elem.html(o),elem.show()}},getTrackShipment:function(){li_fn.flushOldContents(),$(".help-text").on("click",function(){var e=Object.assign({Source:"post_order"},analyticsObj);clevertap.event.push("order_status_help",e),ga("send",{hitType:"event",eventCategory:"post_order",eventAction:"order_status_help",eventLabel:JSON.stringify(analyticsObj)}),window.location.href="/faq/postorder"}),$("#webView").length&&$("#webView").hide();var e=[],a="",t="";-1==window.location.href.indexOf("#")?(e=window.location.href.split("/"),a=e[e.length-1]):(e=window.location.href.split(/['/','#']+/),a=e[e.length-2],t=e[e.length-1]),fn.ajaxForm({order_id:a},"POST","/customer/li-track-shipment").done(function(e){var a=JSON.parse(e);if(li_fn.checkout.variableWeightAdjustment(a.data.shipments[0].variation_explainer,a.data.shipments[0].amount),200===a.statusCode){var s=a.data.loyalty_status;if(s.is_subscribed)if(null!==s.message&&(document.querySelector(".ll-message").innerHTML="<div class=\"ll-free-message\"> <span class=\"message-text\"> ".concat(s.message," </span></div>")),null!==s.purchased_banner){var i=document.querySelector(".ll-purchased-item");document.getElementsByName("isLoyaltyPurchased")[0].value=!0,i.innerHTML="<div class=\"loyalty-purchased-item\">\n                                                <img src=\"/images/licious-meatopia-logo.svg\" style=\"padding:5px\" />\n                                                <div class=\"separator\" style=\"opacity: 0.25\"></div>\n                                                <div class=\"ll-details\">\n                                                    <div class=\"ll-item-name\"> <span> ".concat(s.purchased_banner.plan_details.program_name,"</span></div>\n                                                    <div class=\"ll-price-sec\">\n                                                      <div class=\"ll-plan-name\"> <span> ").concat(s.purchased_banner.plan_details.plan_name," </span> </div>\n                                                      <div> <span style=\"color:#313131; padding: 0 15px;opacity:0.25\"> | </span> </div>\n                                                      <div class=\"ll-act-price\"> <span> ").concat(0>=s.purchased_banner.plan_details.strike_price-s.purchased_banner.plan_details.actual_price?"":"\u20B9 ".concat(s.purchased_banner.plan_details.strike_price," ")," </span> </div>\n                                                      <div class=\"ll-price\"> <span> \u20B9 ").concat(s.purchased_banner.plan_details.actual_price," </span> </div>\n                                                    </div>           \n                                                </div>\n                                          </div>")}else if(null===s.purchased_banner){var i=document.querySelector(".ll-item");i.innerHTML=" <div class=\"home-page-loyalty-member-banner\">\n                                                <img src=\"/images/licious-meatopia-logo.svg\" class=\"home-page-loyalty-banner-licious-member-logo\">\n                                                <div class=\"home-page-loyalty-member-banner-vertical-separator\" ></div>\n                                                <div class=\"home-page-loyalty-member-info\">\n                                                  <div class=\"home-page-loyalty-member-expiry-info\">".concat(s.cumulative_banner.remaining_days," days left in your plan</div>\n                                                  <div class=\"home-page-loyalty-member-orders-savings-info\" style=\"margin-top:5px;\">\n                                                    <span class=\"home-page-loyalty-member-orders\">").concat(s.cumulative_banner.total_orders," orders placed</span>\n                                                    <div class=\"home-page-loyalty-member-info-separator\" style=\"margin: 6px 10px 0;\"></div>\n                                                    <span class=\"home-page-loyalty-member-orders\">\u20B9").concat(s.cumulative_banner.total_saving," total savings </span>\n                                                  </div>\n                                                </div>\n                                              </div>")}}if($(".arrivalInfoBlade").hide(),$("#map").hide(),$(".arrivalinfo").hide(),$(".arrivalimage").hide(),"success"==a.statusMessage){analyticsObj.user_type=a.data.customer_type,localStorage.setItem("user_type",a.data.customer_type);var o=a.data.shipments,r=a.data.payment_info;if("CREATED_WITH_FAILURE"===r.payment_status?li_fn.checkout.renderFailTimerPayButtonView(r):"CREATED_WITH_UNKNOWN"===r.payment_status?li_fn.checkout.renderUnknownBanner(r):fn.clearAutoRenewFromSession(),$(".order-successfull .shipments-slot").html(""),$(".newShipmentSlot .shipmentSlotContainer").html(""),$.map(o,function(e,a){var t="<div class=\"shipmentActiveTextContainer\" ><div class=\"shipmentText order_"+e.order_id+"\"index=\""+a+"\" data-order_id=\""+e.order_id+"\">"+e.shipment_messages.label+"</div></div>";$(".newShipmentSlot .shipmentSlotContainer").append(t)}),""!=t){$(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText.order_"+t).addClass("active");var d=o.filter(function(e){return e.order_id==t});localStorage.setItem("analytics_shipment_id",d[0].order_id),li_fn.mapAnalyticsAttributes(d[0],"order-shipments"),invoice_order_id=d[0].order_id,invoice_order_date=d[0].order_processing_date,localStorage.setItem("state_id",d[0].state_id),li_fn.checkout.renderTrackData(r,d[0],t),3==d[0].state_id&&(localStorage.setItem("Poll",!0),fn.msite.showloader(),li_fn.checkout.getTrackStatus())}else $(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText.order_"+o[0].order_id).addClass("active"),localStorage.setItem("state_id",o[0].state_id),localStorage.setItem("analytics_shipment_id",o[0].order_id),invoice_order_id=o[0].order_id,invoice_order_date=o[0].order_processing_date,li_fn.mapAnalyticsAttributes(o[0],"order-shipments"),li_fn.checkout.renderTrackData(r,o[0],o[0].order_id),3==o[0].state_id&&(localStorage.setItem("Poll",!0),fn.msite.showloader(),li_fn.checkout.getTrackStatus());$(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText").on("click",function(a){a.stopImmediatePropagation();var e=$(this).attr("data-order_id"),t=o.filter(function(a){return a.order_id==e});localStorage.setItem("analytics_shipment_id",t[0].order_id),li_fn.mapAnalyticsAttributes(t[0],"order-shipments"),clevertap.event.push("Shipment Switch Bar",{Source:"Order"}),ga("send",{hitType:"event",eventCategory:"Order",eventAction:"Shipment",eventLabel:JSON.stringify({Source:"Order"})}),$(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText").removeClass("active"),$(".arrivalInfoBlade").hide(),$("#map").hide(),$("#webView").hide(),$(".arrivalinfo").hide(),$(".arrivalimage").hide(),$(".newShipmentHeaderContainer").show(),invoice_order_id=t[0].order_id,invoice_order_date=t[0].order_processing_date,li_fn.checkout.renderTrackData(r,t[0],e),localStorage.setItem("state_id",t[0].state_id),fn.msite.showloader(),localStorage.setItem("Poll",!0),li_fn.checkout.getTrackStatus(),li_fn.checkout.variableWeightAdjustment(t[0].variation_explainer,t[0].amount),"0"===$(this).attr("index")?$(".ll-purchased-item").show():$(".ll-purchased-item").hide()})}})},renderFailureData:function(e,a,t){$(".newOrderStatusFullContainer .waiting-loader-container").length&&$(".newOrderStatusFullContainer .waiting-loader-container").remove(),$(".track-container .track-status-image").html(""),$(".track-container .track-bar").html(""),$(".newShipProductsWrapper").html(""),$(".newShipmentHeaderContainer").html(""),$(".newOrderStatusContainer").html(""),$(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText.order_"+a.order_id).addClass("active"),$(".newShipmentHeaderContainer").html(li_fn.getShipmentHeader(a.shipment_messages,a.order_id));var s="",s=a.price_variance&&a.price_variance.badge_message&&!a.shipment_stages[1].eg_message?"<div class=\"badge_message\">("+a.price_variance.badge_message+")<span class=\"scrollBill_"+t+"\">View</span></div>":"";1===a.state_id?li_fn.validateShipments(a)&&$(".newOrderStatusContainer").append(li_fn.getStateOneTimeLine(a.shipment_stages,s)):2===a.state_id?li_fn.validateShipments(a)&&$(".newOrderStatusContainer").append(li_fn.getStateTwoTimeLine(a.shipment_stages,s)):3===a.state_id?li_fn.validateShipments(a)&&$(".newOrderStatusContainer").append(li_fn.getStateThreeTimeLine(a.shipment_stages,s,null)):4===a.state_id,$(".eg-message").on("click",function(a){a.stopImmediatePropagation(),$("html, body").animate({scrollTop:$(".BillCardContainer").position().top})}),$(".BillCardContainer ul").html("<div class=\"billHeader\">Bill Detail</div>"),li_fn.generateBillList(a.amount.split,a.price_variance),$(".addrDeliveryContainer .firstLine").html(a.shipment_messages.items_message),$(".addrDeliveryContainer .secondLine .addr_div").html(a.delivery_address),li_fn.renderProductList(a.shipment_items),0==a.offers.length?$(".offer-wrapper").hide():($(".offer-wrapper").show(),$(".offer-wrapper").html(""),$.map(a.offers,function(e,a){var t="<a class=\"offer-img\" href=\""+e.web_url+"\" data-index=\""+(a+1)+"\" data-name=\""+e.name+"\"><img src=\""+e.app_image_url+"\"></a>";$(".offer-wrapper").append(t)}),$(".offer-wrapper").cycle({slides:"> a",timeout:3e3})),$(".offer-wrapper").css("margin-bottom","80px")},renderUnknownData:function(e,a,t){$(".newTimerConatiner").length&&$(".newTimerConatiner").remove(),$(".track-container .track-status-image").html(""),$(".track-container .track-bar").html(""),$(".shipment-products").html(""),$(".newShipProductsWrapper").html(""),$(".newShipmentHeaderContainer").html(""),$(".newOrderStatusContainer").html(""),$(".new-payment-failed").hide(),$(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText.order_"+t).addClass("active"),$(".newShipmentHeaderContainer ").append(li_fn.getShipmentHeader(a.shipment_messages,a.order_id));var s=a.price_variance&&a.price_variance.badge_message&&!a.shipment_stages[1].eg_message?"<div class=\"badge_message\">("+a.price_variance.badge_message+")<span class=\"scrollBill\">View</span></div>":"";1===a.state_id?li_fn.validateShipments(a)&&$(".newOrderStatusContainer").append(li_fn.getStateOneTimeLine(a.shipment_stages,s)):2===a.state_id?li_fn.validateShipments(a)&&$(".newOrderStatusContainer").append(li_fn.getStateTwoTimeLine(a.shipment_stages,s)):3===a.state_id?li_fn.validateShipments(a)&&$(".newOrderStatusContainer").append(li_fn.getStateThreeTimeLine(a.shipment_stages,s,null)):4===a.state_id,$(".eg-message").on("click",function(a){a.stopImmediatePropagation(),$("html, body").animate({scrollTop:$(".BillCardContainer").position().top})});var i="",o=[];-1==window.location.href.indexOf("#")?(o=window.location.href.split("/"),i=o[o.length-1]):(o=window.location.href.split(/['/','#']+/),i=o[o.length-2]);var r=setInterval(function(){li_fn.checkout.getPaymentStatus(i).done(function(e){e=JSON.parse(e),e&&e.data&&"unknown"!==e.data.status&&clearInterval(r)})},1e4);$(".BillCardContainer ul").html("<div class=\"billHeader\">Bill Detail</div>"),li_fn.generateBillList(a.amount.split,a.price_variance),$(".addrDeliveryContainer .firstLine").html(a.shipment_messages.items_message),$(".addrDeliveryContainer .secondLine .addr_div").html(a.delivery_address),li_fn.renderProductList(a.shipment_items),0==a.offers.length?$(".offer-wrapper").hide():($(".offer-wrapper").show(),$(".offer-wrapper").html(""),$.map(a.offers,function(e,a){var t="<a class=\"offer-img\" href=\""+e.web_url+"\" data-index=\""+(a+1)+"\" data-name=\""+e.name+"\"><img src=\""+e.app_image_url+"\"></a>";$(".offer-wrapper").append(t)}),$(".offer-wrapper").cycle({slides:"> a",timeout:3e3})),$(".offer-wrapper").css("margin-bottom","80px"),$(".order").on("click",function(){window.location.href="/customer/payments?orderId="+e.parent_order_id})},removeUnsuccessFullContainers:function(){$(".newOrderStatusFullContainer .waiting-loader-container").length&&$(".newOrderStatusFullContainer .waiting-loader-container").remove(),$(".newOrderStatusFullContainer .new-payment-failed").length&&$(".new-payment-failed").remove(),$(".timerContainer").length&&$(".timerContainer").remove(),$(".newTimerConatiner").length&&$(".newTimerConatiner").remove(),$(".place-order").length&&$(".place-order").remove(),$(".not-confirmed").length&&$(".not-confirmed").remove()},renderTrackData:function(e,a,t){if("CREATED_WITH_FAILURE"===e.payment_status)return li_fn.checkout.renderFailureData(e,a,t),null;if("CREATED_WITH_UNKNOWN"===e.payment_status)return li_fn.checkout.renderUnknownData(e,a,t),null;li_fn.checkout.removeUnsuccessFullContainers(),$(".rr-wrap").hide(),$(".contact-list").show(),$(".shipment-wrapper").show(),$(".newShipmentSlot .shipmentSlotContainer .shipmentActiveTextContainer .shipmentText.order_"+t).addClass("active"),$(".cancel_pop_whole_container").attr("order_id",t),$(".track-container .track-status-image").html(""),$(".track-container .track-bar").html(""),$(".newOrderStatusContainer").html(""),$(".shipment-products").html(""),$(".newShipProductsWrapper").html(""),$(".newShipmentHeaderContainer .headerContent").html(""),a.is_order_edited?$(".newOrderStatusContainer").attr("edit-order-status","true"):!1==a.is_order_edited&&$(".newOrderStatusContainer").attr("edit-order-status","false");"<div class=\"image\"><img src=\""+a.shipment_messages.image+"\"></div><div class=\"status-heading\">"+a.shipment_messages.message+"</div><div class=\"status-message\">"+a.shipment_messages.slot_message+"</div>";$(".newShipmentHeaderContainer").append(li_fn.getShipmentHeader(a.shipment_messages,a.order_id));var s="<div class=\"ticked\">&#10003;</div><span>"+a.shipment_messages.status_message+"</span>",i="";if(a.price_variance&&a.price_variance.badge_message&&!a.shipment_stages[1].eg_message&&(i="<div class=\"badge_message\">("+a.price_variance.badge_message+")<span class="+t+" data-order_id="+t+">View</span></div>",$(".badge_message."+t).addClass("active")),localStorage.setItem("order_status",a.shipment_messages.status_message),1===a.state_id?li_fn.validateShipments(a)&&$(".newOrderStatusContainer").append(li_fn.getStateOneTimeLine(a.shipment_stages,i)):2===a.state_id?li_fn.validateShipments(a)&&$(".newOrderStatusContainer").append(li_fn.getStateTwoTimeLine(a.shipment_stages,i)):3===a.state_id?li_fn.validateShipments(a)&&$(".newOrderStatusContainer").append(li_fn.getStateThreeTimeLine(a.shipment_stages,i,null)):4===a.state_id&&(0==a.is_reviewed?($(".newOrderStatusFullContainer").css("margin-bottom","0px"),$(".rr-wrap").show(),fn.msite.home.getReviewRating("Order status page",a.order_id)):$(".rr-wrap").hide()),$(".eg-message").on("click",function(a){a.stopImmediatePropagation(),$("html, body").animate({scrollTop:$(".BillCardContainer").position().top})}),a){$(".addrDeliveryContainer .firstLine").html(a.shipment_messages.items_message),$(".addrDeliveryContainer .secondLine .addr_div").html(a.delivery_address),$(".contact-list .email a").html(a.shipment_messages.email),$(".contact-list .email a").attr("href","mailto:"+a.shipment_messages.email),$(".contact-list .email a").attr("data-shipment_id",a.order_id),$(".contact-list .email a").attr("data-status",a.shipment_messages.status_message),$(".contact-list .call a").html(a.shipment_messages.phone),$(".contact-list .call a").attr("href","tel:"+a.shipment_messages.phone),$(".contact-list .call a").attr("data-shipment_id",a.order_id),$(".contact-list .call a").attr("data-status",a.shipment_messages.status_message),$(".shipment-wrapper .shipment-header .message").html(a.shipment_messages.items_message),a&&a.hasOwnProperty("customer_cancellation")?(li_fn.checkout.cancel_order.checkIfCancelOrderEnabled(a.customer_cancellation)?li_fn.checkout.cancel_order.populateCancelOrderFields(a.customer_cancellation,a.state_id):($(".cancle_btn_div").hide(),$(".addrDeliveryContainer .addr_div").css("width","100%"),$(".firstLine").css("width","100%")),5===a.state_id&&a.customer_cancellation.hasOwnProperty("refund_meta")?li_fn.checkout.cancel_order.populateRefundToast(a.customer_cancellation.refund_meta):$(".refund_toast_container").hide()):($(".cancle_btn_div").hide(),$(".addrDeliveryContainer .addr_div").css("width","100%"),$(".firstLine").css("width","100%")),li_fn.renderProductList(a.shipment_items),$(".delivery-charges-wrapper .header").html("Total &#8377; "+a.amount.total+" ( "+a.amount.break_down_msg+" )"),$(".delivery-charges-wrapper .charges-container").html("");var o="";if("paid"==a.amount.payment_status.toLowerCase()&&"razorpay"==a.amount.payment_type.toLowerCase()&&(o="<img class=\"paid-online-image\" src=\"/images/paid.png\"/> "),$(".BillCardContainer ul").html("<div class=\"billHeader\"> <span class=\"headertext\"> Bill Detail </span>"+o+" </div> "),li_fn.generateBillList(a.amount.split,a.price_variance),downloadInvoice="<li><div class=\"downloadInvoiceConatiner\"><div class=\"billImage\"><img src=\"/images/bill generated.svg\"></div><div class=\"textContainer\">Invoice<span>Download your invoice copy</span></div><img class=\"downloadIcon\" src=\"/images/download-arrow.png\" download id=\"downloadId\"></div></div></li>",4===a.state_id&&$(".BillCardContainer ul").append(downloadInvoice),""!=a.amount.cod_info_message&&($(".order-successfull .success-message").html(a.amount.cod_info_message),$(".order-successfull .success-message").css("display","block")),5==a.state_id&&($(".track-container .track-bar").hide(),$(".thirdLine").hide()),"paid"==a.amount.payment_status.toLowerCase()&&"cod"==a.amount.payment_type.toLowerCase()?($(".shipment-header .paid-image").css("display","block"),$(".paid-image").attr("src","/images/cod-track.png"),$(".paid-image").css("width","60px")):"paid"==a.amount.payment_status.toLowerCase()?($(".shipment-header .paid-image").css("display","block"),$(".paid-image").attr("src","/images/paid.png")):$(".shipment-header .paid-image").css("display","none"),0==a.offers.length?$(".offer-wrapper").hide():($(".offer-wrapper").show(),$(".offer-wrapper").html(""),$.map(a.offers,function(e,a){var t="<a class=\"offer-img\" href=\""+e.web_url+"\" data-index=\""+(a+1)+"\" data-name=\""+e.name+"\"><img src=\""+e.app_image_url+"\"></a>";$(".offer-wrapper").append(t)}),$(".offer-wrapper").cycle({slides:"> a",timeout:3e3})),!0==a.amount.is_payble&&3<=a.state_id){$(".newOrderStatusFullContainer").css("margin-bottom","80px"),$(".orderstatus-pay-later").addClass("show"),$(".pay-paylater.track-order").attr("data-url","/customer/order-status/"+t),$(".offer-wrapper").css("margin-bottom","80px"),$(".orderstatus-pay-later .total .pay-amount").html(a.amount.total),localStorage.setItem("payable-amount",a.amount.total);var r={shipment_amt:a.amount.total,shipment_id:a.order_id,parent_order_id:a.parent_order_id,order_charges:a.amount.split};localStorage.setItem("pay_later_data",JSON.stringify(r))}else $(".orderstatus-pay-later").removeClass("show"),localStorage.setItem("payable-amount",""),localStorage.setItem("pay_later_data","");4==a.state_id&&0==a.is_reviewed&&$(".offer-wrapper").css("margin-bottom","0px");var d=a.amount.split;$.map(d,function(e){if("total"!=e.key.toLowerCase()){var a="wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase()?"L_wallet":"",t="<li class=\"pay_list \" data-attribute=\""+e.attribute+"\" data-values=\""+e.value+"\"><span class=\"key\">"+e.attribute+"</span><span class=\"value "+a+"\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</span></li>";$(".pay-break-down").find(".payment-charges").append(t)}else $(".pay-paylater").attr("data-amount",+e.value)}),$(".offer-img").on("click",function(){clevertap.event.push("Promo Banner",{Source:"Order","Banner Name":$(this).attr("data-name"),Position:$(this).attr("data-index"),Type:""}),ga("send",{hitType:"event",eventCategory:"Order",eventAction:"Order_Promo",eventLabel:JSON.stringify({Source:"Order","Banner Name":$(this).attr("data-name"),Position:$(this).attr("data-index"),Type:""})})}),$(document).on("click",".productCartContainer",function(){var e=$(this).attr("cat"),a=$(this).attr("p_name"),t=$(this).attr("cat_slug"),s=$(this).attr("prod_slug"),i=Object.assign({productname:a,category:e},analyticsObj),o=Object.assign({Source:"post_order"},i);clevertap.event.push("order_status_view_product",o),ga("send",{hitType:"event",eventCategory:"post_order",eventAction:"order_status_view_product",eventLabel:JSON.stringify(i)}),""!=t&&""!=s&&(e=e.toLowerCase(),setTimeout(function(){window.location.href="/"+t+"/"+s},300))}),$(document).on("click",".pay-paylater",function(a){var e="";if(null!=localStorage.getItem("pay_later_data")&&""!=localStorage.getItem("pay_later_data")){var t=function(e){return"deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase()};e=JSON.parse(localStorage.getItem("pay_later_data")).order_charges[JSON.parse(localStorage.getItem("pay_later_data")).order_charges.findIndex(t)].value.toString()}var s=Object.assign({de_name:localStorage.getItem("de_name"),deliveryspeed:localStorage.getItem("deliveryspeed"),eta:localStorage.getItem("eta"),deliverycharge:e},analyticsObj),i=li_fn.addCleverTapAttr("post_order");i=Object.assign(i,s),a.stopImmediatePropagation(),localStorage.setItem("Pay_later",!0),clevertap.event.push("order_status_pay",i),ga("send",{hitType:"event",eventCategory:"post_order",eventAction:"order_status_pay",eventLabel:JSON.stringify(s)});var o=localStorage.getItem("analytics_shipment_id");setTimeout(function(){window.location.href="/customer/payments?orderId="+o},300)}),$(document).on("click",".offer-wrapper",function(a){a.stopImmediatePropagation(),li_fn.sendAnalyticsData("order_status_view_banner","post_order")}),$(document).on("click",".downloadInvoiceConatiner",function(a){a.stopImmediatePropagation();var e=invoice_order_id+"_"+invoice_order_date;li_fn.getInvoiceURL(e)}),$(document).on("click",".BillContainerActive",function(a){a.stopImmediatePropagation();var e=invoice_order_id+"_"+invoice_order_date;li_fn.getInvoiceURL(e)}),$(document).on("click",".concentricBillActive",function(a){a.stopImmediatePropagation();var e=invoice_order_id+"_"+invoice_order_date;li_fn.getInvoiceURL(e)}),$(document).on("click",".stateThreeBillActive",function(a){a.stopImmediatePropagation();var e=invoice_order_id+"_"+invoice_order_date;li_fn.getInvoiceURL(e)}),$(document).on("click",".stateFourBillActive",function(a){a.stopImmediatePropagation();var e=invoice_order_id+"_"+invoice_order_date;li_fn.getInvoiceURL(e)}),$(document).on("click",".phoneContainerActive",function(){var e=li_fn.addCleverTapAttr("post_order");clevertap.event.push("order_status_call_de",e),ga("send",{hitType:"event",eventCategory:"post_order",eventAction:"order_status_call_de",eventLabel:JSON.stringify(analyticsObj)})}),$(document).on("click",".badge_message",function(a){a.stopImmediatePropagation();var e=li_fn.addCleverTapAttr("post_order");clevertap.event.push("order_status_view_excess_grammage",e),ga("send",{hitType:"event",eventCategory:"post_order",eventAction:"order_status_view_excess_grammage",eventLabel:JSON.stringify(analyticsObj)}),$("html,body").animate({scrollTop:$(".BillCardContainer").offset().top},"slow")})}},trackOrderEvent:function(e,a){var t={Source:"Order","Shipment No":a.order_id,"Order Status":a.shipment_messages.status_message},s=[];$.map(a.amount.split,function(e){"total"==e.key.toLowerCase()&&Object.assign(t,{"Total Amount":e.value}),"discount"==e.key.toLowerCase()&&Object.assign(t,{Discount:e.value})}),$.map(a.shipment_items,function(e){s.push(e.product_name)}),Object.assign(t,{"Shipment Product":s.toString()}),e.on("click",function(){clevertap.event.push("Track Order",t),ga("send",{hitType:"event",eventCategory:"Order",eventAction:"Order_Track",eventLabel:JSON.stringify(t)})})},deleteSummaryItemSuccess:function(e,a,t){var s=e.attr("data-shipid"),i=e.attr("data-pr_name"),o=e.attr("data-cat_name"),r=e.attr("data-is_split"),d=e.parents(".shipment-slots").find(".time-slot.ship_"+s).attr("data-time"),n=e.parents(".shipment-slots").hasClass("express-delivery")?"Express":"Scheduled",l=e.parents(".shipment-slots");fn.msite.showloader(),fn.msite.deleteShipmentItem(a,s).done(function(e){var c=JSON.parse(e);if("success"==c.status){var p="Select delivery slot"==d?"":d,m={Source:"Checkout_Slot","Product Name":i,"Category Name":o,"Shipment ID":+s,"Product ID":a,"City Name":fn.cityName,"Hub ID":+fn.hubId,Slot:n,"Is Split Order":!("true"!=r),"Scheduled Slot Selected":p,is_combo:+t},u={"Product Name":i,"Category Name":o,"Shipment ID":+s,"Product ID":a,"City Name":fn.cityName,"Hub ID":+fn.hubId,Slot:n,"Is Split Order":r,"Scheduled Slot Selected":p};clevertap.event.push("Remove Items",m),ga("send",{hitType:"event",eventCategory:"checkout_Slot",eventAction:"Checkout_Slot_RemoveItem",eventLabel:JSON.stringify(u)}),!0==c.empty?(l.remove(),li_fn.checkout.checkoutMsg("empty"," "),fn.msite.hideloader()):li_fn.checkout.getShipmentSummary().then(function(){0<+t&&(!$(".cart-summary-wrapper .freeDeliveryOrders").css("display")?!$(".whole-container .multi-order").css("display")?($(".combo-removal-msg").show(),setTimeout(function(){$(".combo-removal-msg").hide()},5e3)):($(".combo-removal-msg").show(),$(".multi-order").hide(),setTimeout(function(){$(".combo-removal-msg").hide(),$(".multi-order").show()},5e3)):($(".combo-removal-msg").show(),$("#combo-removal-msg").addClass("overlay-message"),setTimeout(function(){$("#combo-removal-msg").hide()},5e3)))})["finally"](function(){fn.msite.hideloader()})}}).always(function(){})},deleteSummaryItem:function(){$(".delete-item").on("click",function(a){a.stopImmediatePropagation();var e=$(this).attr("data-pr_id"),t=$(this),s=t.attr("data-shipid"),i=t.attr("data-pr_name"),o=t.attr("data-cat_name"),r=t.attr("data-is_split"),d=t.parents(".shipment-slots").find(".time-slot.ship_"+s).attr("data-time"),n=t.parents(".shipment-slots").hasClass("express-delivery")?"Express":"Scheduled",l=!("true"!=r),c="Select delivery slot"==d?"":d,p=$(this).data("is_combo_child"),m=$(this).data("title"),u=$(this).data("description"),h=$(this).data("alert_message");p?($(".combo-popup-header").html(m),$(".combo-popup-text").html(u),$(".action-yes").html("Remove"),$(".action-no").html("Don't Remove"),$(".combo-popup").addClass("show"),$(".action-yes").unbind("click"),$(".action-yes").click(function(){$(".combo-popup").removeClass("show"),$(".combo-removal-msg").html(h),li_fn.checkout.deleteSummaryItemSuccess(t,e,"1")}),$(".action-no").click(function(){var a={Source:"Checkout_Slot","Product Name":i,"Category Name":o,"Shipment ID":+s,"Product ID":e,"City Name":fn.cityName,"Hub ID":+fn.hubId,Slot:n,"Is Split Order":l,"Scheduled Slot Selected":c};clevertap.event.push("Del_ComboModal_DontRemove",a),$(".combo-popup").removeClass("show")}),$(".cross").click(function(){var a={Source:"Checkout_Slot","Product Name":i,"Category Name":o,"Shipment ID":+s,"Product ID":e,"City Name":fn.cityName,"Hub ID":+fn.hubId,Slot:n,"Is Split Order":l,"Scheduled Slot Selected":c};clevertap.event.push("Del_ComboModal_DontRemove",a),$(".combo-popup").removeClass("show")})):li_fn.checkout.deleteSummaryItemSuccess(t,e,"0")})},displaydate:function(e){return e.getDate()==new Date().getDate()?"Today":e.getDate()==new Date().getDate()+1?"Tomorrow":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]},formatDate:function(e){var a=e.getDate(),t=e.getMonth(),s=e.getFullYear();return a+" "+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t]},sortJSONObject:function(e){var a=e.sort(function(e,a){return e.priority-a.priority});return a},applyCoupon:function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:null;$(".apply_btn").on("click",function(t){t.stopImmediatePropagation();var e=$(".c_code").val(),s=$(this);if(""==e||0==e.replace(/^\s+|\s+$/g,"").length)return $(".coupon-wrapper").find(".cpn-val").remove(),$(".coupon-wrapper").append("<div class='cpn-val cpn'></div>"),$(".cpn-val").append("Please Enter Your Coupon"),$(".coupon-wrapper").append("<div class='cpn-val cpn'></div>"),!1;$(".coupon-wrapper").find(".cpn-val").remove();var i={coupon:e,uid:fn.getDeviceFingerPrint()};"true"===$(".apply_btn").attr("auto_ref")&&e===sessionStorage.getItem("auto_ref_code")||$(".remove_coupon").attr("auto_ref","false"),fn.msite.showloader(),$(".apply_btn").prop("disabled",!0),!a||(i.type="loyalty"),fn.ajaxForm(i,"POST","/checkout_oos/apply-coupon").done(function(t){var s=JSON.parse(t);if("success"==s.status){if(s.hasOwnProperty("auto_renewal_content")&&!!s.auto_renewal_content&&Object.keys(s.auto_renewal_content).length&&fn.getAutoRenewalFlag()){fn.msite.hideloader();var i=s.auto_renewal_content,o=i.content_btn_no,r=i.content_btn_yes,d=i.content_desc,n=i.content_header;$(".auto-renew-popup-header .heading").html(n),$(".auto-renew-popup-text").html(d),$(".action-no").html(o),$(".action-yes").html(r),$(".auto-renew-popup").addClass("show")}!sessionStorage.getItem("meatopia_coupon")||(li_fn.checkout.sendCouponPopUpEventDismiss(s,!0),sessionStorage.removeItem("meatopia_coupon")),$(".apply_btn").prop("disabled",!1),$(".licious_wallet").prop("checked",!1);var l="\n                    <div class=\"dashed_container\">\n                    <div class=\"coupon_parent\">\n                      <div class=\"coupon_header\">\n                        Coupon code\n                      </div>\n                      <div class=\"coupon_data_container\">\n                        <div class=\"cpn_code\">\n                          ".concat(s.cart.coupon,"\n                        </div>\n                        <button class=\"remove_referral_btn\">\n                          <span>REMOVE</span>\n                        </button>\n                      </div>\n                      <div class=\"cpn_sucess\">\n                        <div class=\"cpn_success_msg\">\n                          <span class=\"round-tick-success\"></span>\n                          ").concat(s.message,"\n                        </div>\n                        ").concat("complementry"==s.cart.coupon_type?"<div class=\"complimentery-msg\">".concat(s.cart.complementary_product_message,"</div>"):"","\n                      </div>\n                  </div>\n                </div>\n              ");$(".auto-apply-placeholder").append(l),$(".coupon-wrapper").hide(),$(".auto_coupon_toast").hide(),$(".payment-charges").html(""),localStorage.setItem("discount",s.cart.discount),localStorage.setItem("coupon_used",s.cart.coupon),localStorage.setItem("coupon","yes"),localStorage.setItem("coupon_type",s.cart.coupon_type),$(".remove_btn").attr("data-discount",s.cart.discount),$(".remove_btn").attr("data-coupontype",s.cart.coupon_type),fn.msite.setFinalPayment(100*s.cart.subtotal),localStorage.setItem("web_ordercharges",JSON.stringify(s.order_charges)),$.map(s.order_charges,function(e){if("total"!=e.key.toLowerCase()){var a="wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase()?"L_wallet":"",t=e.message===void 0?"":"<span class=\"message\">"+e.message+"</span>";t=("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&0>=e.value?"<span class=\"message\" style=\"color:#417505\">"+e.message+"</span>":t;var s="<li><div class=\"key\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"value "+a+"\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</div></li>";$(".payment-charges").append(s)}else{fn.paypalPaymentHandler(e.value),$(".pay-amount").html(e.value),$(".order").attr("data-payable_amount",+e.value),localStorage.setItem("final_amt",+e.value),localStorage.setItem("li_pay_amt",+e.value);var i="<li><div class=\"seperator\"></li><li><div class=\"key-total\"><span>"+e.attribute+"</span></div><div class=\"value-total "+a+"\">"+e.value+"</div></li>";$(".payment-charges").append(i)}("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&$(".delivery-fee").html("Delivery fee: "+e.value)}),"REF"===s.cart.coupon?sessionStorage.setItem("auto_ref_code",e):sessionStorage.removeItem("auto_ref_code"),"complementry"==s.cart.coupon_type&&$.map(s.cart.shipments,function(e){$.map(e.products,function(e){if("COMP"==e.product_type){$(".comp-wrap").addClass("show"),$(".coupon-wrapper").hide();var a="<div class=\"item-detail\"><div class=\"img\"><img src=\""+e.image+" \"></div> <div class=\"name style-bold\"><p class=\"pr-name style-bold\">"+e.product_name+"</p><p class=\"detail\"><span class=\"weight dist\">"+e.weight+"</span><span class=\"dist type text-red\">free </span><span class=\"dist qty\">Qty : "+e.quantity+"</span></p></div>";$(".comp-wrap").html(a),$(".c_code").val("")}setTimeout(function(){$(".comp-wrap").removeClass("show")},3e3)})});var c={Source:"Purchase","Total Amount":+s.cart.subtotal,"Coupon Name":s.cart.coupon,"Coupon Type":s.cart.coupon_type,Status:s.status,Message:s.message,"Hub ID":+fn.hubId,"City Name":fn.cityName,Discount:+s.cart.discount,"Licious wallet Amount":+$(".L_wallet").text(),auto_renewal:fn.getAutoRenewalType(),enrolment_type:meatopia_data.getDataByKeyName("enrolment_type"),click_source:meatopia_data.getDataByKeyName("click_source"),meatopia_plan:meatopia_data.getDataByKeyName("selected_plan")},p={"Total Amount":+s.cart.subtotal,"Coupon Name":s.cart.coupon,"Coupon Type":s.cart.coupon_type,Status:s.status,Message:s.message,"Hub ID":+fn.hubId,"City Name":fn.cityName,Discount:+s.cart.discount,"Licious wallet Amount":+$(".L_wallet").text()};a?(ga("send",{hitType:"event",eventCategory:"loyalty",eventAction:"coupon_success_direct",eventLabel:JSON.stringify(c)}),clevertap.event.push("coupon_success_direct",c)):(ga("send",{hitType:"event",eventCategory:"Purchase",eventAction:"Purchase_CouponAdd",eventLabel:JSON.stringify(p)}),clevertap.event.push("Coupon Apply Success",c)),s.free_delivery&&(li_fn.checkout.checkoutAlert("free_delivery",s.free_delivery_message),$(".free_del_msg").removeClass("show")),$(".apply-cpn").on("click",function(){$(".checkout-oos-alert").hide(),ga("send",{hitType:"event",eventCategory:"Purchase",eventAction:"FreeDel_Coupon_Apply",eventLabel:JSON.stringify(p)}),clevertap.event.push("FreeDel_Coupon_Apply",c)}),navigator.userAgent.includes("phonepe-webview")||(null===a?li_fn.payment.liciousWallet().then(function(e){"success"==e&&li_fn.payment.selectLiciousWalletOnLoad()}):li_fn.payment.liciousWallet(a).then(function(e){"success"==e&&li_fn.payment.selectLiciousWalletOnLoad($(".order").attr("loyalty_final_amt"))}))}else{var m={Source:"Purchase","Total Amount":fn.getterLS("final_amt"),"Coupon Name":$(".cpn_code").html().trim(),"Coupon Type":fn.getterLS("coupon_type"),Status:s.status,Message:s.message,"Hub ID":+fn.hubId,"City Name":fn.cityName,Discount:0,"Licious wallet Amount":+$(".L_wallet").text(),auto_renewal:fn.getAutoRenewalType(),enrolment_type:meatopia_data.getDataByKeyName("enrolment_type"),click_source:meatopia_data.getDataByKeyName("click_source"),meatopia_plan:meatopia_data.getDataByKeyName("selected_plan")};$(".coupon-wrapper").find(".cpn-val").remove(),$(".coupon-wrapper").append("<div class='cpn-val cpn'></div>"),$(".cpn-val").css("color","red"),$(".cpn-val").html(s.message),a?clevertap.event.push("coupon_fail_direct",m):clevertap.event.push("Coupon Apply Fail",m)}navigator.userAgent.includes("phonepe-webview")&&$(".L_wallet").parent().remove(),li_fn.checkout.removeCoupon()}).always(function(){$(".apply_btn").prop("disabled",!1),fn.msite.hideloader()})})},removeCouponApi:function(){return fn.ajaxForm({},"POST","/checkout_oos/remove-coupon")},removeCouponDelivery:function(){var e=this,a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"";return new Promise(function(t){discountprice=$(e).attr("data-discount");var s=$(".c_code").val(),i=$(e);localStorage.setItem("Coupon Code",""),fn.msite.showloader(),li_fn.checkout.removeCouponApi().done(function(e){var i=JSON.parse(e);if(err_elem="<div class='cpn-val cpn'></div>","success"==i.status){t(i),$(".cpn-btn.apply_btn").show(),$(".cpn-btn.remove_btn").hide(),$(".coupon-wrapper").append(err_elem),$(".cpn-val").html(i.message),setTimeout(function(){$(".cpn-val").html("")},5e3),$(".coupon-block").show(),$(".cpn-success").removeClass("show"),$(".payment-charges").html(""),$(".licious_wallet").prop("checked",!1),$(".c_code").val(""),fn.msite.setFinalPayment(100*i.data.cart.subtotal),localStorage.setItem("coupon_used",""),localStorage.setItem("discount",""),localStorage.setItem("coupon","No"),localStorage.setItem("web_ordercharges",JSON.stringify(i.order_charges)),$.map(i.order_charges,function(e){if("total"!=e.key.toLowerCase()){var a="wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase()?"L_wallet":"",t=void 0===e.message?"":"<span class=\"message\">"+e.message+"</span>";t=("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&0>=e.value?"<span class=\"message\" style=\"color:#417505\">"+e.message+"</span>":t;var s="<li><div class=\"key\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"value "+a+"\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</div></li>";$(".payment-charges").append(s)}else{fn.paypalPaymentHandler(e.value),$(".pay-amount").html(e.value),$(".order").attr("data-payable_amount",+e.value),localStorage.setItem("final_amt",+e.value),localStorage.setItem("li_pay_amt",+e.value);var i="<li><div class=\"seperator\"></li><li><div class=\"key-total\"><span>"+e.attribute+"</span></div><div class=\"value-total "+a+"\">"+e.value+"</div></li>";$(".payment-charges").append(i)}("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&$(".delivery-fee").html("Delivery fee: "+e.value)});var o={Source:"Purchase","Coupon Name":s,"Coupon Type":$(".remove_btn").attr("data-coupontype"),Status:i.status,Message:i.message,"Hub ID":+fn.hubId,"City ID":+$(".city-id").val(),Discount:+i.data.cart.discount,"Licious wallet Amount":+$(".L_wallet").text(),auto_renewal:fn.getAutoRenewalType(),enrolment_type:meatopia_data.getDataByKeyName("enrolment_type"),meatopia_plan:meatopia_data.getDataByKeyName("selected_plan"),click_source:meatopia_data.getDataByKeyName("click_source")},r={"Coupon Name":s,"Coupon Type":$(".remove_btn").attr("data-coupontype"),Status:i.status,Message:i.message,"Hub ID":+fn.hubId,"City ID":+$(".city-id").val(),Discount:+i.data.cart.discount};"loyalty"===a?(clevertap.event.push("coupon_remove_direct",o),ga("send",{hitType:"event",eventCategory:"loyalty",eventAction:"coupon_remove_direct",eventLabel:JSON.stringify(o)})):(clevertap.event.push("FreeDel_Coupon_Remove",o),clevertap.event.push("Coupon Remove Success",o),ga("send",{hitType:"event",eventCategory:"Purchase",eventAction:"FreeDel_Coupon_Remove",eventLabel:JSON.stringify(r)})),navigator.userAgent.includes("phonepe-webview")||li_fn.payment.liciousWallet(payload).then(function(e){"success"==e&&li_fn.payment.selectLiciousWalletOnLoad(payload.amount)})}}).always(function(){navigator.userAgent.includes("phonepe-webview")&&$(".L_wallet").parent().remove(),fn.msite.hideloader()})})},removeCoupon:function(){$(".remove_btn").on("click",function(a){a.stopImmediatePropagation(),discountprice=$(this).attr("data-discount");var e=$(".c_code").val(),t=$(this);localStorage.setItem("Coupon Code",""),fn.msite.showloader(),fn.ajaxForm({},"POST","/checkout_oos/remove-coupon").done(function(a){var s=JSON.parse(a);if(err_elem="<div class='cpn-val cpn'></div>","success"==s.status){t.hide(),t.parent().find(".apply_btn").show(),$(".coupon-wrapper").append(err_elem),$(".cpn-val").html(s.message),$(".coupon-block").show(),$(".cpn-success").removeClass("show"),$(".payment-charges").html(""),$(".licious_wallet").prop("checked",!1),$(".c_code").val(""),fn.msite.setFinalPayment(100*s.data.cart.subtotal),localStorage.setItem("coupon_used",""),localStorage.setItem("discount",""),localStorage.setItem("coupon","No"),localStorage.setItem("web_ordercharges",JSON.stringify(s.order_charges)),$.map(s.order_charges,function(e){if("total"!=e.key.toLowerCase()){var a="wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase()?"L_wallet":"",t=void 0===e.message?"":"<span class=\"message\">"+e.message+"</span>";t=("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&0>=e.value?"<span class=\"message\" style=\"color:#417505\">"+e.message+"</span>":t;var s="<li><div class=\"key\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"value "+a+"\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</div></li>";$(".payment-charges").append(s)}else{fn.paypalPaymentHandler(e.value),$(".pay-amount").html(e.value),$(".order").attr("data-payable_amount",+e.value),localStorage.setItem("final_amt",+e.value),localStorage.setItem("li_pay_amt",+e.value);var i="<li><div class=\"seperator\"></li><li><div class=\"key-total\"><span>"+e.attribute+"</span></div><div class=\"value-total "+a+"\">"+e.value+"</div></li>";$(".payment-charges").append(i)}("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&$(".delivery-fee").html("Delivery fee: "+e.value)});var i={Source:"Purchase","Coupon Name":e,"Coupon Type":$(".remove_btn").attr("data-coupontype"),Status:s.status,Message:s.message,"Hub ID":+fn.hubId,"City ID":+$(".city-id").val(),Discount:+s.data.cart.discount,auto_renewal:fn.getAutoRenewalType(),enrolment_type:meatopia_data.getDataByKeyName("enrolment_type"),meatopia_plan:meatopia_data.getDataByKeyName("selected_plan"),click_source:meatopia_data.getDataByKeyName("click_source")},o={"Coupon Name":e,"Coupon Type":$(".remove_btn").attr("data-coupontype"),Status:s.status,Message:s.message,"Hub ID":+fn.hubId,"City ID":+$(".city-id").val(),Discount:+s.data.cart.discount};clevertap.event.push("Coupon Remove Success",i),ga("send",{hitType:"event",eventCategory:"Purchase",eventAction:"Purchase_CouponRemove",eventLabel:JSON.stringify(o)}),navigator.userAgent.includes("phonepe-webview")||li_fn.payment.liciousWallet().then(function(e){"success"==e&&li_fn.payment.selectLiciousWalletOnLoad()})}}).always(function(){navigator.userAgent.includes("phonepe-webview")&&$(".L_wallet").parent().remove(),fn.msite.hideloader()})})},getTrackStatus:function(){return"false"===localStorage.getItem("Poll")?void fn.msite.hideloader():void fn.ajaxForm({order_id:$(".shipmentText.active").attr("data-order_id"),type:document.getElementsByName("isLoyaltyPurchased")[0].value?"loyalty":""},"POST","/customer/li-track-status").done(function(e){var a=JSON.parse(e),t=a.data.order;if("success"==a.statusMessage){a.data&&a.data.hasOwnProperty("customer_cancellation")?li_fn.checkout.cancel_order.checkIfCancelOrderEnabled(a.data.customer_cancellation)?li_fn.checkout.cancel_order.populateCancelOrderFields(a.data.customer_cancellation,t.state_id):($(".cancle_btn_div").hide(),$(".addrDeliveryContainer .addr_div").css("width","100%"),$(".firstLine").css("width","100%")):($(".cancle_btn_div").hide(),$(".addrDeliveryContainer .addr_div").css("width","100%"),$(".firstLine").css("width","100%")),li_fn.mapAnalyticsAttributes(t,"track-order"),fn.msite.hideloader();var s=$(".newOrderStatusContainer .eg-message").html(),i=$(".newOrderStatusContainer .concentricBillActive").html()||$(".newOrderStatusContainer .BillContainerActive").html()||$(".newOrderStatusContainer .stateThreeBillActive").html()||$(".newOrderStatusContainer .stateFourBillActive").html();li_fn.flushOldContents(),li_fn.checkout.validateLiveTrack(t.live_track_data)?($("#map").show(),li_fn.checkout.renderTrackLiveView(t.live_track_data),(null===li_fn.map_home_loc||null===li_fn.map_hub_loc)&&li_fn.renderStaticMap(t.live_track_data)):($("#map").length&&$("#map").hide(),$("#webView").length&&$("#webView").hide(),$(".newShipmentHeaderContainer").append(li_fn.getShipmentHeader(t.shipment_messages,t.order_id)),$(".arrivalInfoBlade").hide(),$(".arrivalinfo").hide(),$(".arrivalimage").hide()),localStorage.setItem("order_status",t.shipment_messages.status_message),localStorage.setItem("order_status",t.shipment_messages.status_message);var o=t.price_variance&&t.price_variance.badge_message&&!t.shipment_stages[1].eg_message?"<div class=\"badge_message\">("+t.price_variance.badge_message+")<span class=\"scrollBill\">View</span></div>":"";if(1===t.state_id)t.is_order_edited&&"true"!=$(".newOrderStatusContainer").attr("edit-order-status")?location.reload():li_fn.validateShipments(t)&&$(".newOrderStatusContainer").append(li_fn.getStateOneTimeLine(t.shipment_stages,o));else if(2===t.state_id){t.shipment_stages[1].eg_message?t.shipment_stages[1].eg_message:null;!i&&t.shipment_stages[1].cta_info?location.reload():t.is_order_edited&&"true"!=$(".newOrderStatusContainer").attr("edit-order-status")?location.reload():li_fn.validateShipments(t)&&$(".newOrderStatusContainer").append(li_fn.getStateTwoTimeLine(t.shipment_stages,o))}else if(3===t.state_id)li_fn.validateShipments(t)&&$(".newOrderStatusContainer").append(li_fn.getStateThreeTimeLine(t.shipment_stages,o,t.live_track_data.de_phone)),$(".ll-message").hide();else if(4===t.state_id)0==t.is_reviewed&&($(".newOrderStatusFullContainer").css("margin-bottom","0px"),$(".rr-wrap").show(),fn.msite.home.getReviewRating("Order status page",$(".shipmentText.active").attr("data-order_id")));else;$(".eg-message").on("click",function(a){a.stopImmediatePropagation(),$("html, body").animate({scrollTop:$(".BillCardContainer").position().top})});var r="";"paid"==t.amount.payment_status.toLowerCase()&&"razorpay"==t.amount.payment_type.toLowerCase()&&(r="<img class=\"paid-online-image\" src=\"/images/paid.png\"/> "),!0==t.amount.is_payble&&3<=t.state_id?($(".newOrderStatusFullContainer").css("margin-bottom","80px"),$(".orderstatus-pay-later").addClass("show"),$(".offer-wrapper").css("margin-bottom","80px"),$(".orderstatus-pay-later .total .pay-amount").html(t.amount.total),localStorage.setItem("payable-amount",t.amount.total)):($(".orderstatus-pay-later").removeClass("show"),localStorage.setItem("payable-amount",""),localStorage.setItem("pay_later_data",""));var d=t.amount.split;$.map(d,function(e){if("total"!=e.key.toLowerCase()){var a="wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase()?"L_wallet":"",t="<li class=\"pay_list \" data-attribute=\""+e.attribute+"\" data-values=\""+e.value+"\"><span class=\"key\">"+e.attribute+"</span><span class=\"value "+a+"\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</span></li>";$(".pay-break-down").find(".payment-charges").append(t)}else $(".pay-paylater").attr("data-amount",+e.value)}),4==t.state_id?(localStorage.setItem("Poll",!1),0==t.is_reviewed&&$(".offer-wrapper").css("margin-bottom","0px"),$(".newShipmentHeaderContainer .headerContent").show()):localStorage.setItem("Poll",!0)}else fn.msite.hideloader()}).fail(function(){fn.msite.hideloader(),$("#map").length&&$("#map").hide(),$("#webView").length&&$("#webView").hide(),$(".newShipmentHeaderContainer .headerContent").show(),$(".arrivalInfoBlade").hide()})},eventclickAddress:function(e,a){clevertap.event.push(e,{Source:"CartView"}),ga("send",{hitType:"event",eventCategory:"CartView",eventAction:a,eventLabel:""})},eventAddressPage:function(e,a,t){clevertap.event.push(e,{Source:"Checkout_address","Saved address":a}),ga("send",{hitType:"event",eventCategory:"Checkout_address",eventAction:t,eventLabel:""})},PaymentMethodevent:function(e){if(""==localStorage.getItem("pay_later_data")){var a={Checkout_Flow:fn.msite.getCheckoutFlowType(),Source:"Purchase","Payment Method":e,Total:+localStorage.getItem("li_pay_amt"),"City Name":fn.cityName,hub_id:fn.getterLS("hub"),"Category ID":fn.getCategoryId()};"true"==$(".order").attr("data-l_wallet")?Object.assign(a,{"Licious Wallet Status":"true","Licious Wallet used Value":+localStorage.getItem("licious_usable_amount")}):Object.assign(a,{"Licious Wallet Status":"false","Licious Wallet used Value":0}),clevertap.event.push("Payment Method Selected",a),ga("send",{hitType:"event",eventCategory:"Purchase",eventAction:"Purchase_paymentMethod",eventLabel:JSON.stringify(a)})}else{var t={Source:"Order","Payment Method":e,Total:+localStorage.getItem("li_pay_amt")};"true"==$(".order").attr("data-l_wallet")?Object.assign(t,{"Licious Wallet Status":"true","Licious Wallet used Value":+localStorage.getItem("licious_usable_amount")}):Object.assign(t,{"Licious Wallet Status":"false","Licious Wallet used Value":0}),clevertap.event.push("Order Pay on Delivery",t),ga("send",{hitType:"event",eventCategory:"Order",eventAction:"Order_PODPay",eventLabel:JSON.stringify(t)})}},clickPay:function(){if(""==localStorage.getItem("pay_later_data")){var e=$(".order").attr("data-methodname"),a={Checkout_Flow:fn.msite.getCheckoutFlowType(),Source:"Purchase","Payment Method":e,Total:localStorage.getItem("li_pay_amt"),"Coupon Name":localStorage.getItem("coupon"),"Coupon Type":localStorage.getItem("coupon_type"),"City Name":fn.cityName,hub_id:fn.getterLS("hub"),paytm_balance:localStorage.getItem("payable_wallet_amt"),"Category ID":fn.getCategoryId()};"true"==$(".order").attr("data-l_wallet")?Object.assign(a,{"Licious Wallet Status":"true","Licious Wallet used Value":+localStorage.getItem("licious_usable_amount")}):Object.assign(a,{"Licious Wallet Status":"false","Licious Wallet used Value":0}),clevertap.event.push("Proceed to payment Gateway",a),ga("send",{hitType:"event",eventCategory:"Purchase",eventAction:"Purchase_charged",eventLabel:JSON.stringify(a)});var t={total:localStorage.getItem("li_pay_amt"),payment_method:$(".order").attr("data-methodname")?$(".order").attr("data-methodname"):""};if(fn.msite.branchIO.addEvent("proceed_to_pay",t),window.dataLayer){var s=window.dataLayer;s.push({event:"proceed_to_pay",ecommerce:{currencyCode:"INR",actionField:a}})}}else{var e=$(".order").attr("data-methodname"),i={Source:"Order","Payment Method":e,Total:localStorage.getItem("li_pay_amt")};"true"==$(".order").attr("data-l_wallet")?Object.assign(i,{"Licious Wallet Status":"true","Licious Wallet used Value":+localStorage.getItem("licious_usable_amount")}):Object.assign(i,{"Licious Wallet Status":"false","Licious Wallet used Value":0}),clevertap.event.push("Order_PayLater",i),ga("send",{hitType:"event",eventCategory:"Order",eventAction:"Order_PayLater",eventLabel:JSON.stringify(i)})}},cardFormValidate:function(){var e=!0,a=$("#card_number").val(),t=$("#name_on_card").val(),s=$("#expiry_month").val(),i=$("#expiry_year").val(),o=/^\d+$/,r=$("#card_cvv").val();return o.test(a)?/^([a-zA-Z ]{3,30})$/.test(t)?/^01|02|03|04|05|06|07|08|09|10|11|12$/.test(s)?/^2017|2018|2019|2020|2021|2022|2023|2024|2025|2026|2027|2028|2029|2030|2031|2032|2033|2034|2035|2036|2037|2038|2039|2040$/.test(i)?!o.test(r)&&(localStorage.setItem("card_msg","Please enter correct cvv"),e=!1):(localStorage.setItem("card_msg","Incorrect expiry year"),e=!1):(localStorage.setItem("card_msg","Incorrect expiry month"),e=!1):(localStorage.setItem("card_msg","Invalid card name"),e=!1):(localStorage.setItem("card_msg","Invalid card number"),e=!1),e},orderReload:function(){document.getElementById("order_iframe").src+=""}},payment:{captureLoyaltyPayment:function(e){return fn.msite.showloader(),fn.ajaxForm({payload:e},"POST","/loyalty/loyalty-razorpay-capture-payment")},captureSubscriptionPayment:function(e){return e.customer_key=$(".customer_key_value").val(),fn.msite.showloader(),fn.ajaxForm({payload:e},"POST","/loyalty/subscription-razorpay-capture-payment")},capturePayment:function(e){return fn.msite.showloader(),fn.ajaxForm({payload:e},"POST","/customer/razorpay-capture-payment")},getPaymentDetail:function(e,a){var t=window.location.href.includes("subscription"),s="/customer/li-fetch-payment-detail";a!=null&&(s+="?type="+e+"&order_id="+a);var i={};"loyalty"===e?i={type:"loyalty"}:"meatopia_auto_renewal"==e&&(s+="?type="+e,$(".usable-cash").hide(),$(".cash-only").hide()),("loyalty"===e||"meatopia_auto_renewal"===e)&&($(".pay-method.pod").remove(),$(".pay-method.cod").remove(),$(".bonus-cash").hide(),$(".delivery-fee").addClass("hide")),fn.msite.showloader(),fn.ajaxForm(i,"GET",s).done(function(e){var a=JSON.parse(e);"success"==a.statusMessage?(t?(a.data.hasOwnProperty("auto_renew_auth_msg")&&a.data.auto_renew_auth_msg&&$(".auto_renew_toast").html(a.data.auto_renew_auth_msg),$(".pay_btn_sub").attr("auth_amt",a.data.auto_renewal_amount)):fn.getAutoRenewalFlag()?($(".select-save-card").hide(),a.data.hasOwnProperty("auto_renew_non_auth_msg")&&a.data.auto_renew_non_auth_msg&&$(".auto_renew_toast").html(a.data.auto_renew_non_auth_msg)):$(".auto_renew_toast").hide(),a.data.hasOwnProperty("contactless_delivery")&&li_fn.contactless.checkForContactLess(a.data.contactless_delivery)&&li_fn.contactless.populateContactlessDetails(a.data.contactless_delivery),$.map(a.data.payments,function(e){switch(e.group_name){case"preferred_payments":if(0<e.payment_methods.length){var a=$(".saved-payments .save-methods");$.map(e.payment_methods,function(e){"saved_cards"==e.payment_code&&!0==e.enabled&&($(".saved-payments").addClass("show"),fn.ajaxForm({email:localStorage.getItem("user_email"),name:localStorage.getItem("user_name"),phone:localStorage.getItem("user_contact")},"POST","/customer/li-fetch-card").done(function(e){var t=JSON.parse(e);$(".razorpay-id").val(t.data.razorpay_customer_token),t.data.tokens&&0<t.data.tokens.items.length?($(".razorpay-id").attr("data-is_saved",!0),$.map(t.data.tokens.items,function(e){var t="";t="Visa"==e.card.network?"/images/visa_pay.png":"MasterCard"==e.card.network?"/images/mastercard_pay.png":"RuPay"==e.card.network?"/images/rupay.png":"American Express"==e.card.network?"/images/amex.png":"/images/generic.png";var s="<div class=\"options cards saved_cards\"><div class=\"payment-type\"><div class=\"pay-img\"><img src=\""+t+"\"></div><div class=\"pay-id\">XXXX XXXX XXXX "+e.card.last4+"</div></div><div class=\"payment-money\"><div class=\"select\"><label class=\"check-container\"><input type=\"checkbox\" class=\"check-payment check-method saved_cards_check\" data-paymethod=\"saved_cards\" data-savemethod=\"true\" data-token=\""+e.token+"\" data-id=\""+e.id+"\"><span class=\"checkmark\"></span></label></div></div><div class=\"cvv-field\"><input type=\"password\" maxlength=\"4\" class=\"cvv-number\" placeholder=\"Enter CVV\"></div> </div>";a.append(s)})):($(".saved-payments").hide(),$(".razorpay-id").attr("data-is_saved",!1))}))})}break;case"razorpay_wallets":$(".pay-method.other-wallet").addClass("show");var s=$(".pay-method.razorpay_wallets .pay-section .popular-bank");$(".pay-details.wallet").attr("data-isactive",e.enabled),e.meta.disable_message?$(".pay-details.wallet").attr("data-msg",e.meta.disable_message):$(".pay-details.wallet").attr("data-msg",""),s.html("");var i="<span class=\"pay-img\"><img src=\""+e.meta.icon_url+"\"></span><span class=\"pay-name\">"+e.display_name+"</span>";$(".pay-method.razorpay_wallets").find(".method-type").append(i),$.map(e.payment_methods,function(e){var a="<li class=\"bank-detail\"> <div class=\"left\"><span class=\"bank-icon\" style=\"width: 50px;\"><img src=\""+e.meta.icon_url+"\"></span><span class=\"bank-promo\" style=\"margin-left: 10px ; color:#417505; font-size: 10px;\">"+e.meta.promo_msg+"</span></div> <div class=\"right\"> <label class=\"check-container\"><input type=\"checkbox\" class=\"wallet_check check-payment sub-method o_wallet\" data-paysource="+e.payment_code+"  data-check="+e.enabled+" data-msg=\""+e.meta.disable_message+"\"><span class=\"checkmark\"></span></label></div></li>";s.append(a)}),li_fn.checkout.handlePayOptionDisplay(e.enabled,$(".pay-details.wallet"));break;case"razorpay_upi":if(!0==e.enabled&&0<e.payment_methods.length){$(".pay-method.razorpay-upi").addClass("show"),$(".pay-method.razorpay-upi .pay-details-upi.upi-pay .upi-header").html(e.display_name);var o=$(".pay-method.razorpay-upi .pay-details-upi.upi-pay .upi-container");$(".pay-method.razorpay-upi .pay-details-upi.upi-pay").attr("data-isactive",e.enabled),e.meta.disable_message?$(".pay-method.razorpay-upi .pay-details-upi.upi-pay .upi-container").attr("data-msg",e.meta.disable_message):$(".pay-method.razorpay-upi .pay-details-upi.upi-pay .upi-container").attr("data-msg",""),o.html(""),$.map(e.payment_methods,function(e,a){var t="<button class=\"upi-card "+e.payment_code+"\" data-method=\"upi\" data-methodname=\"upi\" data-paysource=\""+e.payment_code+"\" data-index=\""+a+"\" data-enabled=\""+(!0==e.enabled?"true":"false")+"\"><div class=\"upi-image "+(""==e.meta.promo_msg&&""==e.meta.disable_message?"center-fit":"")+"\"><img src=\""+e.meta.icon_url+"\" class=\""+(!1==e.enabled?"disable-img":"")+"\"><span>"+("g_pay"==e.payment_code?"":e.display_name)+"</span></div><p class=\"upi-offer\">"+(!0==e.enabled?e.meta.promo_msg:"")+"</p><p class=\"dis-msg\">"+(!1==e.enabled?e.meta.disable_message:"")+"</p><div class=\"button-check\"></div></button>";o.append(t)}),li_fn.checkout.handlePayOptionDisplay(e.enabled,o)}break;case"razorpay_cards":$(".pay-method.credit-debit").addClass("show");var r="<span class=\"pay-img\"><img src=\""+e.meta.icon_url+"\"></span><span class=\"pay-name\">"+e.display_name+"</span>";$(".pay-method.razorpay_cards").find(".method-type").append(r),$(".pay-details.ccdc").attr("data-isactive",e.enabled),e.meta.disable_message?$(".pay-details.ccdc").attr("data-msg",e.meta.disable_message):$(".pay-details.ccdc").attr("data-msg",""),li_fn.checkout.handlePayOptionDisplay(e.enabled,$(".pay-method.credit-debit"));break;case"razorpay_netbanking":$(".pay-method.netbanking").addClass("show");var d=$(".pay-method.razorpay_netbanking .pay-section .popular-bank"),n="<span class=\"pay-img\"><img src=\""+e.meta.icon_url+"\"></span><span class=\"pay-name\">"+e.display_name+"</span>";$(".pay-method.netbanking").find(".method-type").append(n),$(".pay-details.netbank").attr("data-isactive",e.enabled),e.meta.disable_message?$(".pay-details.netbank").attr("data-msg",e.meta.disable_message):$(".pay-details.netbank").attr("data-msg",""),$.map(e.payment_methods,function(e){var a="<li class=\"bank-detail\"><div class=\"left\"><span class=\"bank-icon\"><img src=\""+e.meta.icon_url+"\"></span><span class=\"bank-name\">"+e.name+"</span><span class=\"bank-promo\" style=\"margin-left: 10px;color:#417505;\">"+e.meta.promo_msg+"</span></div><div class=\"right\"><label class=\"check-container\"><input type=\"checkbox\" class=\"check-payment sub-method imp-banks\" data-paysource="+e.payment_code+"><span class=\"checkmark\"></span></label></div></li>";d.append(a)}),$.map(e.payment_content.payment_list,function(e,a){$(".pay-method .bank-list ul").append("<li class=\"sub-method\" data-paysource="+a+" data-bankname=\""+e+"\"><span class=\"\">"+e+"</span></li>")}),li_fn.checkout.handlePayOptionDisplay(e.enabled,$(".pay-method.netbanking"));break;case"pod":$(".pay-method.pod").addClass("show");var l="<span class=\"pay-img\"><img src=\""+e.meta.icon_url+"\"></span><span class=\"pay-name\">"+e.display_name+"</span>";$(".pay-method.pod").find(".method-type").append(l),$(".pay-details.pay-later").attr("data-isactive",e.enabled),e.meta.disable_message?$(".pay-details.pay-later").attr("data-msg",e.meta.disable_message):$(".pay-details.pay-later").attr("data-msg",""),li_fn.checkout.handlePayOptionDisplay(e.enabled,$(".pay-method.pod"));break;case"cod":$(".pay-method.cod").addClass("show");var c="<span class=\"pay-img\"><img src=\""+e.meta.icon_url+"\"></span><span class=\"pay-name\">"+e.display_name+"</span>";$(".pay-method.cod").find(".method-type").append(c),$(".pay-details.cash").attr("data-isactive",e.enabled),e.meta.disable_message?$(".pay-details.cash").attr("data-msg",e.meta.disable_message):$(".pay-details.cash").attr("data-msg",""),li_fn.checkout.handlePayOptionDisplay(e.enabled,$(".pay-method.cod"));break;case"paytm":$(".pay-method.pp").addClass("show");var p="<span class=\"pay-img\"><img src=\""+e.meta.icon_url+"\"></span><span class=\"pay-before\">&nbsp; (Includes food wallet) </span><span class=\"pay-name\">"+localStorage.getItem("user_contact")+"</span><span class=\"pay-after\">&nbsp; (Includes food wallet) </span>";$(".pay-method.pp .paytm-details").find(".method-type").append(p),$(".paytm-details.paytm").attr("data-isactive",e.enabled),e.meta.disable_message?$(".paytm-details.paytm").attr("data-msg",e.meta.disable_message):$(".pay-details.paytm").attr("data-msg",""),e.meta.disable_message?$(".pay-method.pp").attr("data-msg",e.meta.disable_message):$(".pay-method.pp").attr("data-msg",""),!e.enabled&&(fn.getAutoRenewalFlag()||window.location.href.includes("subscription"))&&($(".check-otp").css("pointer-events","none"),$(".paytm-check").css("pointer-events","none")),li_fn.checkout.handlePayOptionDisplay(e.enabled,$(".pay-method.pp"));break;case"liciouswallet":fn.getAutoRenewalFlag()||t?$(".licious-wallet").addClass("grayed"):$(".licious-wallet").removeClass("grayed"),$(".licious-wallet .wallet-wrap .wallet-money").find(".label-name").html(e.display_name);break;case"paypal":$(".pay-method.paypal").addClass("show");var m="<span class=\"pay-img\"><img src=\""+e.meta.icon_url+"\"></span><span class=\"pay-name\">"+e.display_name+"</span><span class=\"pay-after\" style=\"font-size: 10px; color: blue\"></br> ("+e.meta.promo_msg+") </span>";$(".pay-method.paypal").find(".method-type").append(m),$(".pay-details.paypal").attr("data-isactive",e.enabled),e.meta.disable_message?$(".pay-details.paypal").attr("data-msg",e.meta.disable_message):$(".pay-details.paypal").attr("data-msg","");var u=$(".pay-method.paypal .pay-section .paypal-methods"),h=!1;$.map(e.payment_methods,function(e){"paypal_auto_pay"==e.payment_code&&(!0==e.isBAPresent&&!0==e.enabled&&(h=!0),localStorage.setItem("is_ba_present",e.isBAPresent));var a="<li class=\"paypal-detail\" style=\"padding: 5px 17px;margin-left: 10px;"+(!1==e.enabled?"opacity: 0.4;":"opacity: 1;")+"\" id="+e.payment_code+"><div class=\"left\" style=\"float: left;display: block; width: 80%;\"><span class=\"paymt-name\">"+e.display_name+"</span><span class=\"paymt-email\" style=\"display: block;color:#000;font-size: 10px; width:75%\">"+("paypal_auto_pay"==e.payment_code&&!0==e.isBAPresent?"(Account: <b>"+e.paypal_email+"</b>)":"")+"</span><span class=\"bank-promo\" style=\"display: block;color:#417505;font-size: 10px; width:75%\">"+e.meta.promo_msg+"</span></div><div class=\"right\" style=\"width: 8%;float: right;\"><label class=\"check-container\" style=\"position: absolute;color: #6d6e71;cursor: pointer;font-size: 14px;\"><input class=\"check-payment sub-method\" "+("paypal_auto_pay"==e.payment_code?"id=\"paypal_autocheck_inp\"":"")+"type=\"checkbox\" data-paysource="+e.payment_code+" style=\" position: absolute; opacity: 1;overflow: hidden; width: 18px; top: 0;left: 0;display: block; height: 18px;cursor: pointer;\""+(!0==e.isSelected?"checked;":" ")+(!1==e.enabled?"disabled":" ")+"><span class=\"checkmark\" style=\"position: absolute;top: 0;left: 0;height: 18px;width: 18px;border: 1px solid #cbcbcb;\"></span></label></div></li>";u.append(a)}),h&&$("#paypal_one_time_pay").css("display","none"),li_fn.checkout.handlePayOptionDisplay(e.enabled,$(".pay-method.paypal"));}}),""==localStorage.getItem("pay_later_data")?a.data.messages&&0<a.data.messages.length&&a.data.messages[0]&&$.map(a.data.messages,function(e){if(e&&"free_delivery"===e.condition&&($(".free_del_msg").html(e.message),$(".free_del_msg").addClass("show")),e&&"below_limit"==e.whichEvent){$(".free_del_msg").html(e.message),$(".free_del_msg").addClass("show");var a=JSON.parse(localStorage.getItem("product_data")),t=JSON.parse(localStorage.getItem("web_ordercharges"));if(fn.localStorageCheck(a)&&fn.localStorageCheck(t)){var s={Source:"Purchase","Product Name":a.pr_name,Quantity:a.pr_qty,"Cart Value":+localStorage.getItem("final_amt"),"City Name":fn.cityName,"Hub ID":+fn.hubId};$.map(t,function(e){("deliverycharge"==e.key.toLowerCase()||"delivery_charge"==e.key.toLowerCase())&&Object.assign(s,{"Delivery Charge":e.value})}),clevertap.event.push("Purchase_FreeDel_Remove",s),ga("send",{hitType:"event",eventCategory:"Purchase",eventAction:"Purchase_FreeDel_Remove",eventLabel:JSON.stringify(s)})}}}):($(".free_del_msg").html(""),$(".free_del_msg").removeClass("show")),$(".delivery-waived").on("click",function(){$(".checkout-oos-alert").hide();var e=JSON.parse(localStorage.getItem("product_data")),a=JSON.parse(localStorage.getItem("li_order_charges"));if(fn.localStorageCheck(e)&&fn.localStorageCheck(delivery_data)){var t={"Product Name":e.pr_name,Quantity:e.pr_qty,"City Name":fn.cityName,"Hub ID":fn.hubId};$.map(a,function(e){"total"==e.key.toLowerCase()&&Object.assign(t,{"Cart Value":e.value}),("deliverycharge"==e.key.toLowerCase()||"delivery_charge"==e.key.toLowerCase())&&Object.assign(t,{"Delivery Charge":e.value})}),ga("send",{hitType:"event",eventCategory:"Purchase",eventAction:"Purchase_FreeDel_Remove",eventLabel:JSON.stringify(t)}),clevertap.event.push("Payment Breakdown",t)}})):fn.msite.hideloader()}).always(function(){fn.msite.hideloader()})},liciousWallet:function(e){return void 0!==e&&null!==e&&"string"!=typeof e&&0<Object.keys(e).length?(fn.msite.showloader(),payload=e):payload={orderId:e},fn.getAutoRenewalFlag()&&(payload.flow_type="meatopia_auto_renewal"),new Promise(function(e,a){$(".lic-refresh-loader").hide(),$(".lic-inline-loader").show(),$(".licious_wallet").removeAttr("disabled"),fn.ajaxForm(payload,"POST","/customer/li-licious-wallet").done(function(t){try{var s=JSON.parse(t);if("success"===s.status){li_fn.payment.L_wallet(s),$(".lic-refresh-loader").hide(),$(".lic-inline-loader").hide();var i=!1;s.order_charges.map(function(e){"loyalty"===e.key&&(i=!0)}),$(".order").attr("hasLoyaltyInOrder",i),fn.msite.hideloader(),li_fn.payment.showLoyaltyBreakUp(s.order_charges),e("success")}}catch(e){a("failure"),$(".lic-inline-loader").hide(),$(".lic-refresh-loader").show(),$(".licious_wallet").prop("disabled",!0)}}).fail(function(){a("failure"),$(".lic-refresh-loader").show(),$(".licious_wallet").prop("disabled",!0)}).always(function(){$(".lic-inline-loader").hide(),fn.getAutoRenewalFlag()&&($(".licious_wallet").prop("disabled",!0),$(".licious_wallet").prop("checked",!1))})})},paylaterLiciousWallet:function(e){return new Promise(function(a,t){$(".lic-inline-loader").show(),$(".lic-refresh-loader").hide(),setTimeout(function(){$(".lic-inline-loader").hide()},5e3),$(".licious_wallet").removeAttr("disabled"),fn.ajaxForm({shipmentId:e},"POST","/customer/li-paylater-lwallet").done(function(e){var t=JSON.parse(e);"success"==t.status&&(li_fn.payment.L_wallet(t),a("success"))}).fail(function(){t("failure"),$(".lic-refresh-loader").show(),$(".licious_wallet").prop("disabled",!0)}).always(function(){$(".lic-inline-loader").hide()})})},showLoyaltyBreakUp:function(e){$(".payment-charges").html(""),$.map(e,function(e){if("total"!=e.key.toLowerCase()){var a="wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase()?"L_wallet":"",t=e.message===void 0?"":"<span class=\"message\">"+e.message+"</span>";t=("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&0>=e.value?"<span class=\"message\" style=\"color:#417505\">"+e.message+"</span>":t;var s="<li class=\"pay_list \"><div class=\"key\"><span>"+e.attribute+"</span>"+t+"</div><div class=\"value  "+a+"\">"+(("wallet"==e.key.toLowerCase()||"liciouswallet"==e.key.toLowerCase())&&0<e.value||"discount"==e.key.toLowerCase()&&0<e.value?"-":"")+e.value+"</div></li>";$(".payment-charges").append(s)}else{var i="<li><div class=\"seperator\"></li><li><div class=\"key-total\"><span>"+e.attribute+"</span></div><div class=\"value-total "+a+"\">"+e.value+"</div></li>";$(".payment-charges").append(i),$(".order").attr("loyalty_final_amt",e.value),$(".order").attr("data-payable_amount",+e.value),$(".pay-amount").html(+e.value)}("deliverycharge"===e.key.toLowerCase()||"delivery_charge"===e.key.toLowerCase())&&$(".delivery-fee").html("Delivery fee: \u20B9 "+e.value)})},L_wallet:function(e){if("success"==e.status){$("liciouswallet");$(".usable-licious-amount").html(e.licious_wallet.payable_wallet_amount),$(".cashp").html("&#8377; "+e.licious_wallet.promotional_balance),$(".cash-only .cash").html("&#8377; "+e.licious_wallet.transactional_balance),localStorage.setItem("licious_usable_amount",e.licious_wallet.payable_wallet_amount),0<e.licious_wallet.payable_wallet_amount?($("#lic_wallet").removeAttr("disabled"),localStorage.setItem("payable_wallet_amt",e.licious_wallet.payable_wallet_amount)):($("#lic_wallet").attr("disabled",!0),localStorage.setItem("payable_wallet_amt",e.licious_wallet.payable_wallet_amount))}else $(".lic-refresh-loader").show(),$(".licious_wallet").prop("disabled",!0)},validatePaymethod:function(e,a){var t=!1;switch(e){case"ccdc":var s=$(".card-number").val(),i=$(".card-owner").val(),o=$(".ex-month").val(),r=$(".ex-year").val(),d=$(".cvv").val();return""==s||""==o||""==r||""==d||""==i?(alert("fill detail"),t=!1):li_fn.checkout.cardFormValidate()?t=!0:(alert(localStorage.getItem("card_msg")),t=!1);break;case"netbanking":return""==e||null==e||""==a||null==a?(alert("please select any payment method "),t=!1):t=!0;break;case"upi":var n=$("#user-vpa").val();return""==e||null==e?(alert("please select any payment method "),t=!1):""==n||null==n?($(".error-upi-vpa").html("Please enter VPA ID / UPI ID"),t=!1):/^.+@.+$/.test(n)?($(".error-upi-vpa").html(""),t=!0):($(".error-upi-vpa").html("Please enter a valid VPA ID / UPI ID"),t=!1);case"cod":return!0==$("#cod").is(":checked")?t=!0:(alert("please select any payment method "),t=!1);break;case"pay-later":return!0==$("#pod").is(":checked")?t=!0:(alert("please select any payment method "),t=!1);break;case"other_wallets":return null==a?(alert("please select any payment method "),t=!1):t=!0;break;case"l_wallet":return!0==$("#lic_wallet").is(":checked")?t=!0:(alert("please select any payment method "),t=!1);break;case"saved_cards":var d=$(".saved_cards_check:checkbox:checked").parents(".options").find(".cvv-number").val();return!0!=$(".saved_cards_check").is(":checked")||""==d||null==d?(alert("Something error with payment gateway"),t=!1):t=!0;break;case"paytm":return!0==$("#paytm-pay").is(":checked")?t=!0:(alert("please select any payment method "),t=!1);break;case"phonepe":if(navigator.userAgent.includes("phonepe-webview"))return t=!0;break;case"paypal":return""==e||null==e||""==a||null==a?(alert("please select any payment method "),t=!1):t=!0;default:{return alert("please select any payment method "),t=!1}}},selectLiciousWalletOnLoad:function(e){var a=null!==e&&""!==e&&e!==void 0?+e:+localStorage.getItem("final_amt"),t=+localStorage.getItem("payable_wallet_amt"),s=0;if(0<t&&!fn.getAutoRenewalFlag()){$(".licious_wallet").prop("checked",!0),$(".order").attr("data-l_wallet",!0),$(".pay-method.cod").removeClass("show"),$(".pay-method.pod").removeClass("show"),$(".pay-section").removeClass("show"),$(".pay-arrow img").removeClass("rotate"),$("#pod").prop("checked",!1),$("#cod").prop("checked",!1);var i=+localStorage.getItem("payable_wallet_amt"),o=i>a?0:a-i;localStorage.setItem("wallet_used",+i),s=+(a-t),fn.paypalPaymentHandler(s),$(".pay-amount").html(+(+o).toFixed(2)),$(".value-total").html(+(+o).toFixed(2)),$(".order").attr("data-payable_amount",+o),localStorage.setItem("final_amt",+s);var r=i>a?a:i;localStorage.setItem("l_wallet_used_amount",r),$(".payment-charges").find(".L_wallet").html("-"+ +r),0>=s&&($(".check-payment").prop("checked",!1),$("#paytm-pay").prop("checked",!1),$(".cvv-field").hide(),$(".error-amt").hide(),$(".order").attr("data-method",""),$(".order").attr("data-methodname","l_wallet"),$(".vpa-section").removeClass("show"),$(".upi-container .upi-card").removeClass("selected"),$(".upi-container .upi-card .button-check").removeClass("show"),$(".vpa-section input").val("")),0<t&&fn.getAutoRenewalFlag()&&!!e&&($(".licious_wallet").prop("disabled",!0),$(".licious_wallet").prop("checked",!1),$(".usable-cash").hide(),$(".cash-only").hide()),li_fn.checkout.PaymentMethodevent("Licious Wallet")}},paytmcheckStatus:function(){$(".pay-after").hide(),$(".pay-before").hide(),fn.ajaxForm({},"GET","/customer/paytm-status").done(function(e){var a=JSON.parse(e);200==a.statusCode&&(!0==a.data.verified?($(".paytm-verified").show(),li_fn.payment.paytmGetOtp()):($(".pay-before").show(),$(".paytm-description .check-otp").show()))})},paytmGetOtp:function(){$(".error-paytm-otp").html(""),$(".paytm-inline-loader").hide(),$(".inline-loader").show(),$(".pay-after").hide(),$(".pay-before").hide(),fn.ajaxForm({},"POST","/customer/paytm-signin-otp").done(function(e){var e=JSON.parse(e);"success"==e.status?(0<e.food_balance?$(".pay-after").show():$(".pay-after").hide(),localStorage.setItem("paytm_amt",e.balance),$(".paytm-verified .amount").html("&#8377; "+e.balance)):($(".pay-before").show(),$(".paytm-verification").show(),li_fn.payment.verifyOtpPaytm())}).fail(function(){$(".paytm-inline-loader").show()}).always(function(){$(".inline-loader").hide()})},verifyOtpPaytm:function(){$(".error-paytm-otp").html(""),$(".pay-after").hide(),$(".pay-before").hide(),$(".paytm-verification .verify").on("click",function(){var e=$(".paytm-otp").val();fn.msite.showloader(),fn.ajaxForm({otp:e,phone:localStorage.getItem("user_contact")},"POST","/customer/paytm-verify-otp").done(function(e){var a=JSON.parse(e);"success"==a.status?(0<a.food_balance?$(".pay-after").show():$(".pay-after").hide(),ga("send",{hitType:"event",eventCategory:"Purchase",eventAction:"Paytm_Verify",eventLabel:""}),clevertap.event.push("Paytm_Verify",{Source:"Purchase"}),localStorage.setItem("paytm_amt",a.balance),$(".paytm-verified .amount").html("&#8377; "+a.balance),$(".paytm-verification").hide(),$(".paytm-verified").show()):($(".pay-before").show(),$(".error-paytm-otp").html(a.message),localStorage.setItem("paytm_access_token",""))}).always(function(){fn.msite.hideloader()})})},verifyToken:function(){fn.msite.showloader(),fn.ajaxForm({sso:localStorage.getItem("paytm_access_token")},"POST","/customer/paytm-verify-token").done(function(e){JSON.parse(e);li_fn.payment.paytmWallet()}).always(function(){fn.msite.hideloader()})},paytmWallet:function(){fn.msite.showloader(),fn.ajaxForm({sso:localStorage.getItem("paytm_access_token")},"POST","/customer/paytm-wallet-balance").done(function(e){var a=JSON.parse(e);"SUCCESS"==a.statusMessage&&($(".payment-money .money").html("&#8377; "+a.response.amount),a.response.amount>+localStorage.getItem("final_amt")?($(".pay-section.paytm .verify-customer").css("display","none"),$(".paytm-amount").html("&#8377; "+a.response.amount),$("#paytm-pay").attr("data-paytm_balance",a.response.amount),$(".paytm-auth").css("display","block"),$(".paytm-check").css("display","inline")):($(".pay-section.paytm .verify-customer").css("display","none"),$(".paytm-amount").html("&#8377; "+a.response.amount),$("#paytm-pay").attr("data-paytm_balance",a.response.amount),$(".paytm-auth").css("display","block"),$(".add-paytm-money").css("display","inline")))}).always(function(){fn.msite.hideloader()})},generateCheckSum:function(e,a,t,s,i,o){var r="";fn.ajaxForm({},"GET","/customer/paytm-sso-token").done(function(e){var a=JSON.parse(e);"success"==a.status&&(r=a.sso_token,localStorage.setItem("paytm_access_token",a.sso_token))}),fn.ajaxForm({mobile:a,amt:e,email:localStorage.getItem("user_email"),SSO:localStorage.getItem("paytm_access_token"),REQUEST_TYPE:"ADD_MONEY",payFor:i,plan_id:o,queryOrderId:s},"POST","/customer/li-generate-checksum").done(function(e){li_fn.payment.verifyCheckSum(e,"")})},verifyCheckSum:function(e){$("#paytmssotoken").val(e.SSO_TOKEN),$("#paytmtxtamount").val(e.TXN_AMOUNT),$("#paytmorderid").val(e.ORDER_ID),$("#paytmcustid").val(e.CUST_ID),$("#paytmmobile").val(e.MOBILE_NO),$("#callbackURL").val(e.CALLBACK_URL),fn.ajaxForm({MID:e.MID,ORDER_ID:e.ORDER_ID,CUST_ID:e.CUST_ID,INDUSTRY_TYPE_ID:e.INDUSTRY_TYPE_ID,CHANNEL_ID:"WEB",TXN_AMOUNT:e.TXN_AMOUNT,WEBSITE:e.WEBSITE,CALLBACK_URL:e.CALLBACK_URL,EMAIL:e.EMAIL,MOBILE_NO:e.MOBILE_NO,CHECKSUMHASH:e.CHECKSUMHASH,SSO_TOKEN:e.SSO_TOKEN,REQUEST_TYPE:e.REQUEST_TYPE},"POST","/customer/li-verify-checksum").done(function(e){"true"==e&&li_fn.payment.addMoneyPaytm()})},addMoneyPaytm:function(){$("#paytmForm").submit()},preAuthPaytm:function(e,a,t){li_fn.payment.generateCheckSum(e,a,t)},paytmAuthorization:function(e){fn.ajaxForm({order_id:e.ORDER_ID,amt:e.TXN_AMOUNT,token:localStorage.getItem("paytm_access_token"),csum:e.CHECKSUMHASH},"POST","/customer/paytm-preAuth").done(function(e){JSON.parse(e)})},paytmReleaseAmount:function(){fn.ajaxForm({MID:data.MID,order_id:data.ORDER_ID,amt:data.TXN_AMOUNT,token:localStorage.getItem("paytm_access_token"),csum:data.CHECKSUMHASH},"POST","/customer/paytm-preAuth").done(function(e){JSON.parse(e)})},capturePhonePePayment:function(e){return fn.ajaxForm({reservationId:e},"POST","/customer/capturephonepe")}}};